# Test info

- Name: TRPG Campaign Management >> should handle campaign export/import functionality
- Location: /mnt/c/Users/irure/git/AIAgentTRPGGM/apps/frontend/e2e/trpg-core/campaign-management.spec.ts:257:3

# Error details

```
Error: page.goto: net::ERR_CONNECTION_REFUSED at http://localhost:5173/
Call log:
  - navigating to "http://localhost:5173/", waiting until "load"

    at navigateToTRPGHome (/mnt/c/Users/irure/git/AIAgentTRPGGM/apps/frontend/e2e/utils/trpg-test-helpers.ts:331:14)
    at /mnt/c/Users/irure/git/AIAgentTRPGGM/apps/frontend/e2e/trpg-core/campaign-management.spec.ts:262:11
```

# Test source

```ts
  231 |         description: "„Éë„Éº„ÉÜ„Ç£„ÅåÂ§±„Çè„Çå„ÅüÁéãÂõΩ„ÅÆË™øÊüª‰æùÈ†º„ÇíÂèó„Åë„Çã„ÄÇ",
  232 |         date: "1Êó•ÁõÆ",
  233 |         location: "Ë≥¢ËÄÖ„ÅÆÂ°î",
  234 |         participants: ["„Ç®„É™„Ç¢„Çπ", "„É´„Éä", "„Éû„Çπ„Çø„Éº„Éª„Çª„Ç™„Éê„É´„Éâ"],
  235 |         type: "story",
  236 |         consequences: ["Ë™øÊüª„ÅÆÊñπÂêëÊÄß„ÅåÊ±∫ÂÆö", "„Éë„Éº„ÉÜ„Ç£ÁµêÊàê"]
  237 |       },
  238 |       {
  239 |         id: "event-2",
  240 |         title: "ÈÅ∫Ë∑°„Å∏„ÅÆÈÄ≤ÂÖ•",
  241 |         description: "ÁéãÈÉΩÈÅ∫Ë∑°„ÅÆÂÖ•Âè£„ÇíÁô∫Ë¶ã„Åó„ÄÅÊúÄÂàù„ÅÆÊé¢Á¥¢„ÇíÈñãÂßã„ÄÇ",
  242 |         date: "3Êó•ÁõÆ", 
  243 |         location: "Â§±„Çè„Çå„ÅüÁéãÈÉΩ„ÅÆÈÅ∫Ë∑°",
  244 |         participants: ["„Ç®„É™„Ç¢„Çπ", "„É´„Éä"],
  245 |         type: "exploration",
  246 |         consequences: ["Âè§‰ª£„ÅÆÊñáÂ≠ó„ÅÆÁô∫Ë¶ã", "È≠îÊ≥ï„ÅÆÁΩ†„ÅÆËß£Èô§"]
  247 |       },
  248 |       {
  249 |         id: "event-3",
  250 |         title: "„Ç∑„É£„Éâ„Ç¶„Éä„Ç§„Éà„Å®„ÅÆÈÅ≠ÈÅá",
  251 |         description: "ÁéãÂ∫ß„ÅÆÈñì„Åß„Ç∑„É£„Éâ„Ç¶„Éä„Ç§„Éà„Å®Âàù„ÇÅ„Å¶ÂØæÂ≥ô„ÄÇÊøÄ„Åó„ÅÑÊà¶Èóò„ÅÆÊú´„ÄÅ‰∏ÄÊôÇÊí§ÈÄÄ„ÄÇ",
  252 |         date: "5Êó•ÁõÆ",
  253 |         location: "Â§±„Çè„Çå„ÅüÁéãÈÉΩ„ÅÆÈÅ∫Ë∑° - ÁéãÂ∫ß„ÅÆÈñì",
  254 |         participants: ["„Ç®„É™„Ç¢„Çπ", "„É´„Éä", "„Ç∑„É£„Éâ„Ç¶„Éä„Ç§„Éà"],
  255 |         type: "battle",
  256 |         consequences: ["„Ç∑„É£„Éâ„Ç¶„Éä„Ç§„Éà„ÅÆÂ≠òÂú®Á¢∫Ë™ç", "Âè§‰ª£„ÅÆÂë™„ÅÑ„ÅÆÊâã„Åå„Åã„Çä"]
  257 |       }
  258 |     ],
  259 |     sessions: [
  260 |       {
  261 |         id: "session-1",
  262 |         campaignId,
  263 |         sessionNumber: 1,
  264 |         title: "Ë¨é„Å∏„ÅÆÁ¨¨‰∏ÄÊ≠©",
  265 |         date: "2024-01-15",
  266 |         duration: 240, // 4 hours
  267 |         participants: ["„Ç®„É™„Ç¢„Çπ", "„É´„Éä"],
  268 |         summary: "„Éë„Éº„ÉÜ„Ç£ÁµêÊàê„Å®ÊúÄÂàù„ÅÆË™øÊüª„ÄÇË≥¢ËÄÖ„ÅÆÂ°î„Åß„Éû„Çπ„Çø„Éº„Éª„Çª„Ç™„Éê„É´„Éâ„Åã„Çâ‰æùÈ†º„ÇíÂèó„Åë„ÄÅÂ§±„Çè„Çå„ÅüÁéãÂõΩ„Å´„Å§„ÅÑ„Å¶Âü∫Êú¨ÊÉÖÂ†±„ÇíÂèéÈõÜ„ÄÇ",
  269 |         events: [
  270 |           {
  271 |             id: "session-1-event-1",
  272 |             title: "‰æùÈ†º„ÅÆÂèóË´æ",
  273 |             description: "„Éû„Çπ„Çø„Éº„Éª„Çª„Ç™„Éê„É´„Éâ„Åã„ÇâÂè§‰ª£ÁéãÂõΩË™øÊüª„ÅÆ‰æùÈ†º„ÇíÂèó„Åë„Çã",
  274 |             date: "1Êó•ÁõÆÂçàÂâç",
  275 |             participants: ["„Ç®„É™„Ç¢„Çπ", "„É´„Éä", "„Éû„Çπ„Çø„Éº„Éª„Çª„Ç™„Éê„É´„Éâ"],
  276 |             type: "story",
  277 |             consequences: ["Â†±ÈÖ¨„ÅÆÂèñ„ÇäÊ±∫„ÇÅ", "ÂàùÊúüË£ÖÂÇô„ÅÆÊèê‰æõ"]
  278 |           }
  279 |         ],
  280 |         notes: "„Éó„É¨„Ç§„É§„Éº„ÅÆÁµêÊùü„ÅåËâØ„Åè„ÄÅ„É≠„Éº„É´„Éó„É¨„Ç§„ÅåÊ¥ªÁô∫„Å†„Å£„Åü„ÄÇ"
  281 |       }
  282 |     ]
  283 |   };
  284 | };
  285 |
  286 | /**
  287 |  * Set up TRPG test data in browser storage
  288 |  */
  289 | export const setupTRPGTestData = async (page: Page, campaign?: TRPGCampaign) => {
  290 |   try {
  291 |     const testCampaign = campaign || createTestTRPGCampaign();
  292 |     
  293 |     console.log(`üé≤ Setting up TRPG test data: ${testCampaign.title}`);
  294 |
  295 |     // Initialize TRPG data in localStorage
  296 |     await page.addInitScript((campaignData) => {
  297 |       // Set up TRPG campaigns
  298 |       localStorage.setItem('trpg-campaigns', JSON.stringify([campaignData]));
  299 |       localStorage.setItem('current-campaign-id', campaignData.id);
  300 |       localStorage.setItem('current-campaign', JSON.stringify(campaignData));
  301 |       
  302 |       // Set up characters separately for easier access
  303 |       localStorage.setItem('trpg-player-characters', JSON.stringify(campaignData.playerCharacters));
  304 |       localStorage.setItem('trpg-npcs', JSON.stringify(campaignData.npcs));
  305 |       localStorage.setItem('trpg-enemies', JSON.stringify(campaignData.enemies));
  306 |       
  307 |       // Set up world building data
  308 |       localStorage.setItem('trpg-locations', JSON.stringify(campaignData.locations));
  309 |       localStorage.setItem('trpg-timeline', JSON.stringify(campaignData.timeline));
  310 |       
  311 |       // Set up session data
  312 |       localStorage.setItem('trpg-sessions', JSON.stringify(campaignData.sessions));
  313 |       
  314 |       // Enable developer mode for testing
  315 |       localStorage.setItem('trpg-dev-mode', 'true');
  316 |       
  317 |       console.log('üé≤ TRPG test data initialized in localStorage');
  318 |     }, testCampaign);
  319 |
  320 |     return testCampaign;
  321 |   } catch (error) {
  322 |     console.error('‚ùå Failed to setup TRPG test data:', error);
  323 |     throw error;
  324 |   }
  325 | };
  326 |
  327 | /**
  328 |  * Navigate to TRPG home and ensure campaign is loaded
  329 |  */
  330 | export const navigateToTRPGHome = async (page: Page) => {
> 331 |   await page.goto("/");
      |              ^ Error: page.goto: net::ERR_CONNECTION_REFUSED at http://localhost:5173/
  332 |   await page.waitForLoadState("networkidle");
  333 |   await page.waitForTimeout(2000);
  334 |   
  335 |   // Verify TRPG campaign is loaded
  336 |   const campaignStatus = await page.evaluate(() => {
  337 |     const campaign = localStorage.getItem('current-campaign');
  338 |     const campaignId = localStorage.getItem('current-campaign-id');
  339 |     return {
  340 |       hasCampaign: !!campaign,
  341 |       campaignId,
  342 |       campaign: campaign ? JSON.parse(campaign) : null
  343 |     };
  344 |   });
  345 |   
  346 |   if (!campaignStatus.hasCampaign) {
  347 |     throw new Error('No TRPG campaign loaded');
  348 |   }
  349 |   
  350 |   console.log(`‚úÖ Navigated to TRPG home with campaign: ${campaignStatus.campaign?.title}`);
  351 |   return campaignStatus.campaign;
  352 | };
  353 |
  354 | /**
  355 |  * Create a new TRPG character through the UI
  356 |  */
  357 | export const createTRPGCharacter = async (page: Page, character: Partial<TRPGCharacter>, characterType: 'PC' | 'NPC' | 'Enemy' = 'PC') => {
  358 |   try {
  359 |     console.log(`üßô Creating ${characterType}: ${character.name}`);
  360 |     
  361 |     // Navigate to characters page
  362 |     const pageMap = {
  363 |       'PC': '/characters',
  364 |       'NPC': '/npcs', 
  365 |       'Enemy': '/enemies'
  366 |     };
  367 |     
  368 |     await page.goto(pageMap[characterType]);
  369 |     await page.waitForLoadState("networkidle");
  370 |     
  371 |     // Click create new character button
  372 |     const createButton = page.locator('button:has-text("Êñ∞Ë¶è‰ΩúÊàê"), button:has-text("ËøΩÂä†"), button[aria-label*="ËøΩÂä†"]').first();
  373 |     await expect(createButton).toBeVisible();
  374 |     await createButton.click();
  375 |     
  376 |     // Wait for character form dialog
  377 |     await page.waitForSelector('[role="dialog"]');
  378 |     
  379 |     // Fill character basic information
  380 |     if (character.name) {
  381 |       await page.fill('input[name="name"], input[placeholder*="ÂêçÂâç"]', character.name);
  382 |     }
  383 |     
  384 |     if (character.race) {
  385 |       await page.fill('input[name="race"], input[placeholder*="Á®ÆÊóè"]', character.race);
  386 |     }
  387 |     
  388 |     if (character.class) {
  389 |       await page.fill('input[name="class"], input[placeholder*="„ÇØ„É©„Çπ"]', character.class);
  390 |     }
  391 |     
  392 |     if (character.level) {
  393 |       await page.fill('input[name="level"], input[placeholder*="„É¨„Éô„É´"]', character.level.toString());
  394 |     }
  395 |     
  396 |     // Fill attributes if provided
  397 |     if (character.attributes) {
  398 |       const attributes = character.attributes;
  399 |       for (const [attr, value] of Object.entries(attributes)) {
  400 |         const input = page.locator(`input[name="${attr}"], input[placeholder*="${attr}"]`).first();
  401 |         if (await input.count() > 0) {
  402 |           await input.fill(value.toString());
  403 |         }
  404 |       }
  405 |     }
  406 |     
  407 |     // Fill other fields
  408 |     if (character.background) {
  409 |       await page.fill('input[name="background"], textarea[name="background"]', character.background);
  410 |     }
  411 |     
  412 |     if (character.personality) {
  413 |       await page.fill('textarea[name="personality"], textarea[placeholder*="ÊÄßÊ†º"]', character.personality);
  414 |     }
  415 |     
  416 |     if (character.backstory) {
  417 |       await page.fill('textarea[name="backstory"], textarea[placeholder*="ËÉåÊôØ"]', character.backstory);
  418 |     }
  419 |     
  420 |     // Save character
  421 |     const saveButton = page.locator('button:has-text("‰øùÂ≠ò"), button:has-text("‰ΩúÊàê"), button:has-text("ËøΩÂä†")').last();
  422 |     await expect(saveButton).toBeVisible();
  423 |     await saveButton.click();
  424 |     
  425 |     // Wait for dialog to close
  426 |     await page.waitForSelector('[role="dialog"]', { state: 'detached' });
  427 |     
  428 |     console.log(`‚úÖ Created ${characterType}: ${character.name}`);
  429 |     
  430 |   } catch (error) {
  431 |     console.error(`‚ùå Failed to create ${characterType} ${character.name}:`, error);
```