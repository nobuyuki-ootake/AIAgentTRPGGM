# TRPG AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ GM ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä»•æ§˜æ›¸

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### åŸºæœ¬æƒ…å ±

- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå**: TRPG AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ GM
- **ç›®çš„**: AI ã‚’æ´»ç”¨ã—ãŸ TRPGï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«ãƒˆãƒƒãƒ—ãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ã‚¤ãƒ³ã‚°ã‚²ãƒ¼ãƒ ï¼‰ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç®¡ç†ãƒ»å®Ÿè¡Œã‚·ã‚¹ãƒ†ãƒ 
- **å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼**: TRPG ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã€ã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ã€ã‚·ãƒŠãƒªã‚ªä½œæˆè€…
- **æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯**: React 18, TypeScript, Material-UI, Express.js, SQLite + Litestream, Google Cloud Run

### ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯ã€AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ï¼ˆGMï¼‰ã¨ã—ã¦æ©Ÿèƒ½ã—ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒ TRPG ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½“é¨“ã§ãã‚‹ Web ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨­è¨ˆã‹ã‚‰ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Ÿè¡Œã¾ã§ã€åŒ…æ‹¬çš„ãª TRPG ã‚µãƒãƒ¼ãƒˆã‚’æä¾›ã—ã¾ã™ã€‚

## æŠ€è¡“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£

- **ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆ**: Google Cloud Runï¼ˆãƒãƒ«ãƒã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆï¼‰
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: React SPAï¼ˆCloud Runï¼‰
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Express.js APIï¼ˆCloud Runï¼‰
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: SQLite + Litestreamï¼ˆè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼‰
- **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**: Google Cloud Storageï¼ˆç”»åƒãƒ»ã‚¢ã‚»ãƒƒãƒˆï¼‰
- **AI çµ±åˆ**: OpenAI, Anthropic Claude, Google Vertex AI

### ãƒ¢ãƒãƒªãƒæ§‹æˆ

```
/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ frontend/          # React 18 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
â”‚   â””â”€â”€ proxy-server/      # Express.js ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
â”œâ”€â”€ packages/
â”‚   â””â”€â”€ types/            # å…±æœ‰TypeScriptå‹å®šç¾©
â””â”€â”€ docs/                 # ä»•æ§˜æ›¸ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

## ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ãƒ»å‹å®šç¾©

### ã‚¯ã‚¨ã‚¹ãƒˆã¨ã‚¤ãƒ™ãƒ³ãƒˆã®åˆ†é›¢æ¦‚å¿µ

#### ã‚¯ã‚¨ã‚¹ãƒˆï¼ˆQuestï¼‰
- **ç‰¹å¾´**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèƒ½å‹•çš„ã«é¸æŠãƒ»å—æ³¨ã™ã‚‹ä¾é ¼
- **ç™ºç”Ÿæ¡ä»¶**: 
  - NPCã¨ã®ä¼šè©±
  - é…’å ´ã®ã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ¼ãƒ‰ç¢ºèª
  - ç‰¹å®šã®ã‚¢ã‚¤ãƒ†ãƒ ç™ºè¦‹
- **ç®¡ç†**: PlotPageã§ä¸€è¦§è¡¨ç¤ºãƒ»é€²æ—ç®¡ç†
- **å ±é…¬**: æ˜ç¢ºãªå ±é…¬ãŒè¨­å®šã•ã‚Œã‚‹

#### ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆTimelineEventï¼‰  
- **ç‰¹å¾´**: ç‰¹å®šã®å ´æ‰€ãƒ»æ™‚é–“ã«è‡ªå‹•ç™ºç”Ÿã™ã‚‹ä¸–ç•Œã®å‡ºæ¥äº‹
- **ç™ºç”Ÿæ¡ä»¶**:
  - ç‰¹å®šã®æ—¥æ™‚ãƒ»å ´æ‰€ã«åˆ°é”
  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ä½ç½®ãƒ»è¡Œå‹•
  - å‰æã‚¤ãƒ™ãƒ³ãƒˆã®å®Œäº†
- **ç®¡ç†**: TimelinePageã§ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ä¸Šã«é…ç½®
- **å½±éŸ¿**: ã‚¹ãƒˆãƒ¼ãƒªãƒ¼é€²è¡Œã€ä¸–ç•ŒçŠ¶æ…‹å¤‰åŒ–
- **ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—**:
  - **combat**: æˆ¦é—˜ã‚¤ãƒ™ãƒ³ãƒˆ
  - **social**: ç¤¾äº¤ãƒ»ä¼šè©±ã‚¤ãƒ™ãƒ³ãƒˆ
  - **exploration**: æ¢ç´¢ã‚¤ãƒ™ãƒ³ãƒˆ
  - **environmental**: ç’°å¢ƒå¤‰åŒ–ï¼ˆå¤©å€™ã€ç½å®³ãªã©ï¼‰
  - **story**: ã‚¹ãƒˆãƒ¼ãƒªãƒ¼é€²è¡Œã‚¤ãƒ™ãƒ³ãƒˆ
  - **trap**: ãƒˆãƒ©ãƒƒãƒ—ï¼ˆç½ ï¼‰ã‚¤ãƒ™ãƒ³ãƒˆ

### æ ¸ã¨ãªã‚‹ TRPG å‹å®šç¾©

#### TRPGCampaignï¼ˆã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ï¼‰

```typescript
interface TRPGCampaign {
  id: string;
  title: string;
  synopsis: string;
  gameSystem: string;
  maxPlayers: number;
  characters: TRPGCharacter[];
  enemies: EnemyCharacter[];
  npcs: NPCCharacter[];
  bases: BaseLocation[];
  quests: Quest[];
  events: TimelineEvent[]; // ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ä¸Šã®è‡ªå‹•ç™ºç”Ÿã‚¤ãƒ™ãƒ³ãƒˆ
  sessions: GameSession[];
  worldBuilding: WorldBuildingData;
  rules: CampaignRule[];
  imageUrl?: string;
  created_at: string;
  updated_at: string;
}
```

#### TRPGCharacterï¼ˆStormbringer ãƒ™ãƒ¼ã‚¹ï¼‰

```typescript
interface TRPGCharacter {
  id: string;
  name: string;
  profession: string;
  gender: string;
  age: number;
  nation: string;
  religion: string;
  player: string;
  characterType: "PC" | "NPC";

  // åŸºæœ¬èƒ½åŠ›å€¤
  attributes: {
    STR: number; // ç­‹åŠ›
    CON: number; // è€ä¹…åŠ›
    SIZ: number; // ä½“æ ¼
    INT: number; // çŸ¥æ€§
    POW: number; // é­”åŠ›ãƒ»æ„å¿—åŠ›
    DEX: number; // å™¨ç”¨ã•
    CHA: number; // é­…åŠ›
  };

  // æ´¾ç”Ÿå€¤
  derived: {
    HP: number; // ãƒ’ãƒƒãƒˆãƒã‚¤ãƒ³ãƒˆ
    MP: number; // ãƒã‚¸ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ
    SW: number; // Strike Rankï¼ˆå…ˆåˆ¶å€¤ï¼‰
    RES: number; // æŠµæŠ—å€¤
  };

  // è£…å‚™
  weapons: Weapon[];
  armor: {
    head: number;
    body: number;
    leftArm: number;
    rightArm: number;
    leftLeg: number;
    rightLeg: number;
  };

  // ã‚¹ã‚­ãƒ«ä½“ç³»
  skills: {
    AgilitySkills: Skill[]; // æ•æ·ç³»
    CommunicationSkills: Skill[]; // ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç³»
    KnowledgeSkills: Skill[]; // çŸ¥è­˜ç³»
    ManipulationSkills: Skill[]; // æ“ä½œç³»
    PerceptionSkills: Skill[]; // çŸ¥è¦šç³»
    StealthSkills: Skill[]; // éš å¯†ç³»
    MagicSkills: Skill[]; // é­”æ³•ç³»
    WeaponSkills: Skill[]; // æ­¦å™¨ç³»
  };

  description: string;
  scars?: string;
  imageUrl?: string;
}
```

#### EnemyCharacterï¼ˆæ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ï¼‰

```typescript
interface EnemyCharacter {
  id: string;
  name: string;
  rank: "ãƒ¢ãƒ–" | "ä¸­ãƒœã‚¹" | "ãƒœã‚¹" | "EXãƒœã‚¹";
  type: string;
  description: string;
  level: number;

  // èƒ½åŠ›å€¤ï¼ˆç°¡ç•¥åŒ–ï¼‰
  attributes: {
    strength: number;
    dexterity: number;
    constitution: number;
    intelligence: number;
    wisdom: number;
  };

  // æ´¾ç”Ÿå€¤
  derivedStats: {
    hp: number;
    mp: number;
    attack: number;
    defense: number;
    magicAttack: number;
    magicDefense: number;
    accuracy: number;
    evasion: number;
    criticalRate: number;
    initiative: number;
  };

  // ã‚¹ã‚­ãƒ«ãƒ»è¡Œå‹•
  skills: {
    basicAttack: string;
    specialSkills: SpecialSkill[];
    passives: string[];
  };

  // AIè¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³
  behavior: {
    aiPattern: string;
    targeting: string;
  };

  // ãƒ‰ãƒ­ãƒƒãƒ—
  drops: {
    exp: number;
    gold: number;
    items: string[];
    rareDrops: string[];
  };

  // ç¾åœ¨çŠ¶æ…‹
  status: {
    currentHp: number;
    currentMp: number;
    statusEffects: string[];
    location: string;
  };
}
```

#### Questï¼ˆã‚¯ã‚¨ã‚¹ãƒˆï¼‰

```typescript
interface Quest {
  id: string;
  title: string;
  description: string;
  status: "æœªç™ºè¦‹" | "ç™ºè¦‹æ¸ˆ" | "å—æ³¨å¯èƒ½" | "é€²è¡Œä¸­" | "å®Œäº†" | "å¤±æ•—" | "æ”¾æ£„";
  questType: "ãƒ¡ã‚¤ãƒ³" | "ã‚µãƒ–" | "å€‹äºº" | "éš ã—";
  giver: string; // ä¾é ¼äºº
  prerequisites: string[]; // å‰ææ¡ä»¶
  objectives: QuestObjective[]; // ç›®æ¨™
  rewards: {
    experience: number;
    gold: number;
    items: string[];
    reputation?: { faction: string; amount: number }[];
  };
  deadline?: number; // æœŸé™ï¼ˆæ—¥æ•°ï¼‰
  consequences?: {
    success: string;
    failure: string;
  };
  discoveryConditions: {
    type: "npc_dialogue" | "location" | "item" | "event" | "quest_board";
    details: string;
  }[];
}
```

#### TimelineEventï¼ˆã‚¤ãƒ™ãƒ³ãƒˆï¼‰

```typescript  
interface TimelineEvent {
  id: string;
  title: string;
  description: string;
  eventType: "combat" | "social" | "exploration" | "environmental" | "story" | "trap";
  triggerConditions: {
    day: number;
    time?: string;
    location: string;
    prerequisites?: string[]; // å‰æã‚¤ãƒ™ãƒ³ãƒˆID
  };
  participants: {
    npcs?: string[];
    enemies?: string[];
    requiredPCs?: string[]; // å¿…é ˆå‚åŠ PC
  };
  outcomes: {
    automatic?: string; // è‡ªå‹•çš„ã«èµ·ãã‚‹çµæœ
    playerChoice?: {
      options: string[];
      consequences: string[];
    };
  };
  // ãƒˆãƒ©ãƒƒãƒ—å°‚ç”¨è¨­å®š
  trapDetails?: {
    detectionDC: number; // ç™ºè¦‹é›£æ˜“åº¦
    disarmDC: number; // è§£é™¤é›£æ˜“åº¦
    damage: string; // ãƒ€ãƒ¡ãƒ¼ã‚¸å¼
    savingThrow?: {
      type: string; // ç¨®é¡ï¼ˆæ•æ·ã€è€ä¹…ãªã©ï¼‰
      DC: number; // é›£æ˜“åº¦
    };
    triggered: boolean; // ç™ºå‹•æ¸ˆã¿ãƒ•ãƒ©ã‚°
  };
  worldStateChanges?: {
    faction?: { name: string; reputation: number };
    location?: { id: string; status: string };
    globalFlags?: { [key: string]: boolean };
  };
}
```

#### BaseLocationï¼ˆæ‹ ç‚¹ï¼‰

```typescript
interface BaseLocation {
  id: string;
  name: string;
  type: string;
  region: string;
  description: string;
  rank: string;
  importance: "ä¸»è¦æ‹ ç‚¹" | "ã‚µãƒ–æ‹ ç‚¹" | "éš ã—æ‹ ç‚¹";

  // æ–½è¨­
  facilities: {
    inn?: Inn;
    shops?: Shop[];
    armory?: Armory;
    temple?: Temple;
    guild?: Guild;
    blacksmith?: Blacksmith;
  };

  // NPC
  npcs: LocationNPC[];

  // æ©Ÿèƒ½
  features: {
    fastTravel: boolean;
    playerBase: boolean;
    questHub: boolean;
    defenseEvent: boolean;
  };

  // è„…å¨ãƒ»å½±éŸ¿
  threats: {
    dangerLevel: string;
    currentEvents: string[];
    controllingFaction: string;
  };

  // çµŒæ¸ˆ
  economy: {
    currency: string;
    localGoods: string[];
    tradeGoods: string[];
  };

  imageUrl?: string;
  unlocked: boolean;
}
```

## ç”»é¢æ§‹æˆãƒ»æ©Ÿèƒ½ä»•æ§˜

### 1. ãƒ›ãƒ¼ãƒ ãƒ»ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç®¡ç†ç”»é¢

#### HomePage.tsx

- **ç›®çš„**: ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³é¸æŠãƒ»ç®¡ç†ã®ãƒãƒ–
- **æ©Ÿèƒ½**:
  - æ—¢å­˜ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä¸€è¦§è¡¨ç¤º
  - æ–°è¦ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä½œæˆ
  - ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å‰Šé™¤ãƒ»ç·¨é›†
  - æœ€è¿‘ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¥æ­´è¡¨ç¤º

#### ProjectsPage.tsx

- **ç›®çš„**: ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä¸€è¦§ãƒ»æ¤œç´¢
- **æ©Ÿèƒ½**:
  - ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
  - ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è©³ç´°ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
  - ãŠæ°—ã«å…¥ã‚Šç®¡ç†

### 2. ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨­è¨ˆç”»é¢

#### SynopsisPage.tsxï¼ˆã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³èƒŒæ™¯ï¼‰

- **ç›®çš„**: ã‚·ãƒŠãƒªã‚ªå…¨ä½“è¨­å®šã¨ TRPG ä¸–ç•Œè¦³è¨­å®š
- **æ©Ÿèƒ½**:
  - ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³èƒŒæ™¯è¨­å®š
  - AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç”¨ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­å®š
  - ä¸–ç•Œè¦³ãƒ»è¨­å®šè³‡æ–™ç®¡ç†

#### PlotPage.tsxï¼ˆã‚¯ã‚¨ã‚¹ãƒˆç®¡ç†ï¼‰

- **ç›®çš„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼é¸æŠå‹ã‚¯ã‚¨ã‚¹ãƒˆç®¡ç†
- **æ©Ÿèƒ½**:
  - ã‚¯ã‚¨ã‚¹ãƒˆä¸€è¦§ã®è¡¨ç¤ºãƒ»ç®¡ç†
  - ã‚¯ã‚¨ã‚¹ãƒˆå—æ³¨ãƒ»é€²è¡ŒçŠ¶æ³ç®¡ç†
  - ãƒ¡ã‚¤ãƒ³ã‚¯ã‚¨ã‚¹ãƒˆãƒ»ã‚µãƒ–ã‚¯ã‚¨ã‚¹ãƒˆãƒ»å€‹äººã‚¯ã‚¨ã‚¹ãƒˆã®åˆ†é¡
  - å ±é…¬ãƒ»å‰ææ¡ä»¶ã®è¨­å®š
- **ç‰¹å¾´**:
  - è¡—ã«åˆ°ç€æ™‚ç‚¹ã§ã¯è¡¨ç¤ºã•ã‚Œãªã„
  - NPCã¨ã®ä¼šè©±ã‚„é…’å ´ã®ã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ¼ãƒ‰ã§åˆã‚ã¦ç™ºè¦‹
  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒèƒ½å‹•çš„ã«é¸æŠãƒ»å—æ³¨ã™ã‚‹

#### TimelinePage.tsxï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³å±¥æ­´/ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ï¼‰

- **å‹•ä½œãƒ¢ãƒ¼ãƒ‰**:
  - **ãƒ—ãƒ¬ã‚¤ä¸­ãƒ¢ãƒ¼ãƒ‰**: ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¥æ­´ã¨ã—ã¦å®Ÿéš›ã®ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ãƒ­ã‚°ã‚’è¡¨ç¤º
  - **é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰**: ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ã¨ã—ã¦äº‹å‰ã‚·ãƒŠãƒªã‚ªè¨­è¨ˆæ©Ÿèƒ½
- **åŸºæœ¬æ©Ÿèƒ½**:
  - æ—¥å˜ä½ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ï¼ˆ1 æ—¥ç›®ã€œX æ—¥ç›®ï¼‰
  - å ´æ‰€ãƒ»æ™‚é–“ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ™ãƒ³ãƒˆé…ç½®
  - æ¡ä»¶ç™ºç«å‹ã‚¤ãƒ™ãƒ³ãƒˆã®è¨­è¨ˆ
  - æ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®å ´æ‰€ãƒ»æ—¥ç¨‹å›ºå®šé…ç½®
- **æ—¥æ•°åˆ¶é™è¨­å®š**:
  - **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: 7æ—¥é–“ï¼ˆç´„1æ™‚é–“ã®ãƒ—ãƒ¬ã‚¤æ™‚é–“æƒ³å®šï¼‰
  - **è¨­å®šå¯èƒ½ç¯„å›²**: 1ã€œ365æ—¥
  - **ãƒ—ãƒ¬ã‚¤æ™‚é–“ç›®å®‰**: 1æ—¥ã‚ãŸã‚Šç´„15åˆ†
- **ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç›®çš„é”æˆã‚·ã‚¹ãƒ†ãƒ **:
  - ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã«ã¯æ˜ç¢ºãª**é”æˆç›®æ¨™**ãŒè¨­å®šã•ã‚Œã‚‹
  - è¨­å®šã•ã‚ŒãŸæœ€å¤§æ—¥æ•°ä»¥å†…ã«ç›®çš„ã‚’é”æˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹
  - **æˆåŠŸæ¡ä»¶**: æœ€å¤§æ—¥æ•°å†…ã§ã®ç›®çš„é”æˆ
  - **å¤±æ•—æ¡ä»¶**: æœ€å¤§æ—¥æ•°åˆ°é”æ™‚ç‚¹ã§ã®ç›®çš„æœªé”æˆ
  - AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç›®çš„é”æˆçŠ¶æ³ã‚’ç›£è¦–ãƒ»åˆ¤å®š
- **ã‚¤ãƒ™ãƒ³ãƒˆç‰¹å¾´**:
  - ç‰¹å®šã®å ´æ‰€ãƒ»æ™‚é–“ã«è‡ªå‹•ç™ºç”Ÿ
  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ä½ç½®ãƒ»è¡Œå‹•ã«ã‚ˆã‚Šç™ºç«
  - ã‚¯ã‚¨ã‚¹ãƒˆã¨ã¯ç‹¬ç«‹ã—ãŸä¸–ç•Œã®å‡ºæ¥äº‹

### 3. ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç®¡ç†

#### CharactersPage.tsxï¼ˆãƒ‘ãƒ¼ãƒ†ã‚£ç·¨æˆï¼‰

- **ç›®çš„**: PC ç®¡ç†ãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ç·¨æˆ
- **æ©Ÿèƒ½**:
  - æ–°è¦ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä½œæˆï¼ˆStormbringer ãƒ™ãƒ¼ã‚¹ï¼‰
  - ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚·ãƒ¼ãƒˆç·¨é›†
  - ãƒ‘ãƒ¼ãƒ†ã‚£æ§‹æˆç®¡ç†
  - AI ã«ã‚ˆã‚‹ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”»åƒç”Ÿæˆ

#### EnemyPage.tsxï¼ˆæ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç®¡ç†ï¼‰

- **ç›®çš„**: æ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­è¨ˆãƒ»ç®¡ç†
- **æ©Ÿèƒ½**:
  - ãƒ©ãƒ³ã‚¯åˆ¥æ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä½œæˆï¼ˆãƒ¢ãƒ–/ä¸­ãƒœã‚¹/ãƒœã‚¹ï¼‰
  - AI è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³è¨­å®š
  - æˆ¦é—˜ãƒãƒ©ãƒ³ã‚¹èª¿æ•´
  - ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ã‚¤ãƒ†ãƒ è¨­å®š

#### NPCPage.tsxï¼ˆNPC ç®¡ç†ï¼‰

- **ç›®çš„**: NPC è¨­è¨ˆãƒ»ç®¡ç†
- **æ©Ÿèƒ½**:
  - NPC åŸºæœ¬æƒ…å ±è¨­å®š
  - ä¼šè©±ãƒ‘ã‚¿ãƒ¼ãƒ³è¨­å®š
  - æ‹ ç‚¹é…ç½®ç®¡ç†
  - AI å¯¾è©±ã‚·ã‚¹ãƒ†ãƒ é€£æº

### 4. ä¸–ç•Œè¦³ãƒ»æ‹ ç‚¹ç®¡ç†

#### WorldBuildingPage.tsxï¼ˆãƒ¯ãƒ¼ãƒ«ãƒ‰è¨­å®šï¼‰

- **ç›®çš„**: ä¸–ç•Œè¦³ãƒ‡ãƒ¼ã‚¿ã¨ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ã®å®Œå…¨çµ±åˆ
- **çµ±åˆãƒ“ã‚¸ãƒ§ãƒ³**: ä¸–ç•Œè¦³æ§‹ç¯‰ãƒ‡ãƒ¼ã‚¿ã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ—ãƒ¬ã‚¤ã«ç›´æ¥åæ˜ ã•ã›ã€AIã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ã®åˆ¤æ–­ææ–™ã¨ã—ã¦æ´»ç”¨

##### ğŸŒ ä¸–ç•Œè¦³æ§‹ç¯‰çµ±åˆã‚·ã‚¹ãƒ†ãƒ 

###### **1. å ´æ‰€ä¸­å¿ƒã®å†è¨­è¨ˆ**

```typescript
interface IntegratedLocation extends Base {
  // æ—¢å­˜ã®æ‹ ç‚¹ãƒ‡ãƒ¼ã‚¿ã«åŠ ãˆã¦
  encounterRules: {
    timeOfDay: Record<TimeOfDay, EncounterChance>;
    weatherEffects: WeatherModifier[];
    specialEvents: ConditionalEvent[];
  };
  
  npcSchedule: {
    [npcId: string]: {
      availability: TimeOfDay[];
      services: string[];
      questTriggers: string[];
    };
  };
  
  culturalModifiers: {
    negotiationDC: number;
    priceModifier: number;
    reputationImpact: number;
  };
}
```

###### **2. ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒãƒƒãƒ—UI**

- **è¦–è¦šçš„ä¸–ç•Œç®¡ç†**: 
  - ã‚¯ãƒªãƒƒã‚«ãƒ–ãƒ«ãªå ´æ‰€ãƒãƒ¼ã‚«ãƒ¼
  - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ä½ç½®è¡¨ç¤º
  - ç§»å‹•ãƒ«ãƒ¼ãƒˆã®å¯è¦–åŒ–
  - å±é™ºåº¦ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—è¡¨ç¤º
- **çµ±åˆæƒ…å ±è¡¨ç¤º**:
  - å ´æ‰€ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°æƒ…å ±ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—
  - åˆ©ç”¨å¯èƒ½æ–½è¨­ãƒ»NPCãƒ»ã‚¯ã‚¨ã‚¹ãƒˆä¸€è¦§
  - ç§»å‹•æ™‚é–“ãƒ»ã‚³ã‚¹ãƒˆè¨ˆç®—
  - é­é‡ç¢ºç‡ã®å¯è¦–åŒ–

###### **3. AIã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè‡ªå‹•æ§‹ç¯‰**

```typescript
// ä¸–ç•Œè¦³ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰AIãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è‡ªå‹•ç”Ÿæˆ
const buildAIContext = (location: Base, worldData: WorldBuilding) => {
  return {
    currentLocation: {
      name: location.name,
      description: location.description,
      culture: worldData.cultures.find(c => c.regions.includes(location.id)),
      history: worldData.history.filter(h => h.locations.includes(location.id)),
      politics: worldData.settings.politicalSituation,
    },
    availableActions: generateLocationActions(location),
    environmentalFactors: {
      weather: getCurrentWeather(location),
      timeOfDay: getTimeOfDay(),
      season: getCurrentSeason(),
    },
  };
};
```

###### **4. å¿…è¦æœ€å°é™ã®ç”»é¢æ§‹æˆ**

**æ®‹ã™ã‚¿ãƒ–ï¼ˆã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ç›´çµï¼‰**:
- **å ´æ‰€ç®¡ç†**: æ‹ ç‚¹ã€ãƒ€ãƒ³ã‚¸ãƒ§ãƒ³ã€é‡å¤–ã‚¨ãƒªã‚¢ã®è©³ç´°è¨­å®š
- **NPCé…ç½®**: å ´æ‰€ã”ã¨ã®NPCé…ç½®ã¨å½¹å‰²å®šç¾©
- **é­é‡è¨­å®š**: å ´æ‰€Ã—æ™‚é–“Ã—æ¡ä»¶ã§ã®è‡ªå‹•é­é‡ãƒ«ãƒ¼ãƒ«
- **ã‚¯ã‚¨ã‚¹ãƒˆé€£æº**: å ´æ‰€ã¨ã‚¯ã‚¨ã‚¹ãƒˆã®ç´ä»˜ã‘ç®¡ç†

**AIã«å§”ã­ã‚‹ã‚¿ãƒ–ï¼ˆå‹•çš„ç”Ÿæˆï¼‰**:
- è©³ç´°ãªæ­´å²å¹´è¡¨ï¼ˆå¿…è¦æ™‚ã«AIç”Ÿæˆï¼‰
- è¤‡é›‘ãªæ”¿æ²»ä½“åˆ¶ï¼ˆAIãŒæ–‡è„ˆã«å¿œã˜ã¦èª¬æ˜ï¼‰
- æŠ€è¡“ãƒ¬ãƒ™ãƒ«è©³ç´°ï¼ˆã‚²ãƒ¼ãƒ ã‚·ã‚¹ãƒ†ãƒ ã«æº–æ‹ ï¼‰

###### **5. ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ—ãƒ¬ã‚¤ã¸ã®åæ˜ **

- **å ´æ‰€ç§»å‹•æ™‚ã®è‡ªå‹•å‡¦ç†**:
  - æ–½è¨­ã®å³åº§åˆ©ç”¨å¯èƒ½åŒ–
  - é…ç½®NPCã®è‡ªå‹•è¡¨ç¤º
  - æ–‡åŒ–çš„ä¿®æ­£å€¤ã®é©ç”¨
  - é­é‡ãƒã‚§ãƒƒã‚¯ã®å®Ÿè¡Œ

- **AIå¿œç­”ã¸ã®çµ±åˆ**:
  - å ´æ‰€ã®æ­´å²ãƒ»æ–‡åŒ–ã‚’åæ˜ ã—ãŸæå†™
  - NPCã®åœ°åŸŸæ€§ã‚’è€ƒæ…®ã—ãŸä¼šè©±
  - ç’°å¢ƒè¦å› ã«ã‚ˆã‚‹åˆ¤å®šä¿®æ­£
  - ä¸–ç•Œè¦³ã«åŸºã¥ãã‚¤ãƒ™ãƒ³ãƒˆç”Ÿæˆ

### 5. TRPG ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Ÿè¡Œ

#### TRPGSessionPage.tsxï¼ˆãƒ¡ã‚¤ãƒ³ç”»é¢ï¼‰

- **ç›®çš„**: å®Ÿéš›ã® TRPG ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Ÿè¡Œ
- **ã‚²ãƒ¼ãƒ é€²è¡Œãƒ•ãƒ­ãƒ¼**:

  1. ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠ â†’ ã‚²ãƒ¼ãƒ é–‹å§‹
  2. ã€ŒAIã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ã«ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å§‹ã‚ã¦ã‚‚ã‚‰ã†ã€ãƒœã‚¿ãƒ³ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹
  3. AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹ã‚‰ã®ã‚²ãƒ¼ãƒ å°å…¥ãƒ»çŠ¶æ³èª¬æ˜
  4. è¡Œå‹•é¸æŠï¼ˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæä¾›é¸æŠè‚¢ï¼‰
  5. æ—¥ç¨‹é€²è¡Œï¼ˆè‡ªå‹•åˆ¤å®šã«ã‚ˆã‚‹æ¬¡æ—¥ç§»è¡Œï¼‰

- **æ—¥ç¨‹é€²è¡Œã‚·ã‚¹ãƒ†ãƒ **:
  - **ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚**: AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå®Œäº†æ¡ä»¶ã‚’åˆ¤å®šã—ã¦è‡ªå‹•é€²è¡Œ
  - **ã‚¤ãƒ™ãƒ³ãƒˆæœªç™ºç”Ÿæ™‚**: ç‰¹å®šå›æ•°ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡Œå‹•å¾Œã«æ‰‹å‹•ç¢ºèªã§é€²è¡Œ
  - **ã‚¿ã‚¤ãƒ ãƒªãƒŸãƒƒãƒˆ**: è¨­å®šã•ã‚ŒãŸæœ€å¤§æ—¥æ•°ä»¥å†…ã«ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç›®çš„ã‚’é”æˆ
  - **æˆåŠŸ/å¤±æ•—åˆ¤å®š**: AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒç›®çš„é”æˆçŠ¶æ³ã‚’ç›£è¦–

- **UI æ§‹æˆè¦ç´ **:
  - **ã‚¤ãƒ©ã‚¹ãƒˆè¡¨ç¤º**: ç¾åœ¨åœ°ã®èƒŒæ™¯ç”»åƒ
  - **ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¡¨ç¤º**: å‚åŠ å…¨ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®å¸¸æ™‚è¡¨ç¤º
  - **ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½**: AI GM ã¨ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¼šè©±
  - **è¡Œå‹•é¸æŠãƒ‘ãƒãƒ«**: ç§»å‹•ã€è²·ã„ç‰©ã€NPC ä¼šè©±ã€ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼äº¤æµç­‰
  - **ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ¶å¾¡**:
    - AIã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼é–‹å§‹ãƒœã‚¿ãƒ³
    - æ—¥æ•°è¡¨ç¤ºï¼ˆXæ—¥ç›®/æœ€å¤§æ—¥æ•°ï¼‰
    - ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç›®çš„é”æˆçŠ¶æ³è¡¨ç¤º
  - **ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ UI**:
    - ãƒ€ã‚¤ã‚¹ãƒ­ãƒ¼ãƒ« UI: æ”»æ’ƒå¨åŠ›ãƒ»åˆ¤å®š
    - ã‚¹ã‚­ãƒ«ãƒã‚§ãƒƒã‚¯ UI: å††å½¢ã‚²ãƒ¼ã‚¸åœæ­¢ã‚²ãƒ¼ãƒ 
    - ãƒ‘ãƒ¯ãƒ¼ãƒã‚§ãƒƒã‚¯ UI: é€£æ‰“ã‚²ãƒ¼ãƒ 
  - **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º**: è£…å‚™ãƒ»ã‚¹ã‚­ãƒ«ãƒ»HP/MP ç­‰

### 6. é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰

#### é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½

- **å ´æ‰€**: ã‚µã‚¤ãƒ‰ãƒãƒ¼ä¸‹éƒ¨
- **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: ã‚ªãƒ•çŠ¶æ…‹
- **ã‚ªãƒ•æ™‚**:
  - ã‚²ãƒ¼ãƒ é–‹å§‹å‰: ãƒ‘ãƒ¼ãƒ†ã‚£è¨­å®šã¨ TRPG ã‚»ãƒƒã‚·ãƒ§ãƒ³ç§»è¡Œã®ã¿
  - ã‚²ãƒ¼ãƒ é–‹å§‹å¾Œ: è¨­å®šã‚¿ãƒ–ã¨ AIChat ãƒ‘ãƒãƒ«ãŒéè¡¨ç¤º
  - ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¥æ­´ç”»é¢: ãƒ—ãƒ¬ã‚¤å±¥æ­´ã®é–²è¦§ã®ã¿
- **ã‚ªãƒ³æ™‚**:
  - å…¨è¨­å®šé …ç›®ãŒè¡¨ç¤ºå¯èƒ½
  - ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¥æ­´ç”»é¢: ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ãƒ»äº‹å‰è¨­è¨ˆæ©Ÿèƒ½ãŒåˆ©ç”¨å¯èƒ½
  - AIChatPanel è¡¨ç¤ºï¼ˆå‰µä½œæ”¯æ´ï¼‰

## AI çµ±åˆãƒ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ©Ÿèƒ½

### AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå½¹å‰²

#### å®Ÿè£…æ¸ˆã¿Mastraã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

##### 1. TRPGã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ï¼ˆtrpgGameMasterï¼‰
- **å½¹å‰²**: ã‚»ãƒƒã‚·ãƒ§ãƒ³é€²è¡Œã€ã‚·ãƒŠãƒªã‚ªå±•é–‹ã€NPC æ¼”æŠ€ã€ã‚²ãƒ¼ãƒ ç®¡ç†
- **ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: TRPGã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é€²è¡Œã™ã‚‹AIã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ã¨ã—ã¦ã€å…¬å¹³ã§æ¥½ã—ã‚ã‚‹ä½“é¨“ã‚’æä¾›
- **æ©Ÿèƒ½**:
  - ã‚²ãƒ¼ãƒ å°å…¥ãƒ»çŠ¶æ³èª¬æ˜
  - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¡Œå‹•ã¸ã®åå¿œãƒ»çµæœç”Ÿæˆ
  - æˆ¦é—˜è§£æ±ºãƒ»åˆ¤å®šæ”¯æ´
  - ã‚¹ãƒˆãƒ¼ãƒªãƒ¼é€²è¡Œç®¡ç†
  - **ğŸ² AIåˆ¶å¾¡ãƒ€ã‚¤ã‚¹ã‚·ã‚¹ãƒ†ãƒ **: AIãŒæˆ¦è¡“çš„åˆ¤æ–­ã«åŸºã¥ã„ã¦å¼·åˆ¶ãƒ€ã‚¤ã‚¹ãƒ­ãƒ¼ãƒ«ã‚’è¦æ±‚
    - ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³é€£å‹•é­é‡ã‚·ã‚¹ãƒ†ãƒ 
    - ã‚¨ãƒãƒŸãƒ¼ä¸»å°æ”»æ’ƒãƒ»ã‚µãƒ—ãƒ©ã‚¤ã‚ºåˆ¤å®š
    - æŒ‡å®šãƒ€ã‚¤ã‚¹å¿…é ˆå®Ÿè¡Œï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°å¼·åˆ¶è¡¨ç¤ºï¼‰
    - ãƒ€ã‚¤ã‚¹ãƒ­ãƒ¼ãƒ«å¦¥å½“æ€§æ¤œè¨¼
  - **ã‚¤ãƒ™ãƒ³ãƒˆå®Œäº†æ¡ä»¶åˆ¤å®š**: è¡Œå‹•çµæœã‚’åˆ†æã—ã¦ã‚¤ãƒ™ãƒ³ãƒˆé”æˆã‚’è‡ªå‹•åˆ¤å®š
  - **ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç›®çš„é”æˆç›£è¦–**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é€²è¡ŒçŠ¶æ³ã‚’ç¶™ç¶šçš„ã«è©•ä¾¡
  - **æˆåŠŸ/å¤±æ•—åˆ¤å®š**: æœ€å¤§æ—¥æ•°åˆ°é”æ™‚ã®æœ€çµ‚çš„ãªã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æˆå¦åˆ¤å®š

##### 2. ã‚·ãƒŠãƒªã‚ªãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ï¼ˆscenarioDesignerï¼‰
- **å½¹å‰²**: TRPGã‚·ãƒŠãƒªã‚ªã®è¨­è¨ˆã¨æ”¹å–„ã‚’è¡Œã†ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼
- **ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: ã‚·ãƒŠãƒªã‚ªæ§‹é€ ã®åˆ†æã€ã‚¤ãƒ™ãƒ³ãƒˆé…ç½®ã®æœ€é©åŒ–ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼é¸æŠã®å¤šæ§˜åŒ–ã‚’æ”¯æ´
- **å‡ºåŠ›å½¢å¼**: ã‚¤ãƒ™ãƒ³ãƒˆç”Ÿæˆæ™‚ã¯ã€Œã‚¿ã‚¤ãƒˆãƒ«: [ã‚¤ãƒ™ãƒ³ãƒˆå]ã€ã€Œè©³ç´°: [ç™ºç”Ÿæ¡ä»¶ã€å±•é–‹ã€é¸æŠè‚¢]ã€å½¢å¼

##### 3. TRPGã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ï¼ˆtrpgCharacterCreatorï¼‰
- **å½¹å‰²**: PCã€NPCã€æ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ä½œæˆæ”¯æ´
- **ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: ã‚²ãƒ¼ãƒ ã‚·ã‚¹ãƒ†ãƒ ã«é©ã—ãŸèƒ½åŠ›å€¤é…åˆ†ã€èƒŒæ™¯è¨­å®šã€æˆé•·æ–¹å‘ã®ææ¡ˆ
- **å‡ºåŠ›å½¢å¼**: æ¨™æº–ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚·ãƒ¼ãƒˆå½¢å¼ï¼ˆåå‰ã€ç¨®æ—ã€ã‚¯ãƒ©ã‚¹ã€èƒ½åŠ›å€¤ã€ã‚¹ã‚­ãƒ«ç­‰ï¼‰

##### 4. ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒŠãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼ˆsessionNarratorï¼‰
- **å½¹å‰²**: TRPGã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æƒ…æ™¯æå†™ã¨é€²è¡ŒãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- **ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: äº”æ„Ÿã«è¨´ãˆã‚‹è‡¨å ´æ„Ÿã‚ã‚‹æå†™ã€NPCã®å€‹æ€§çš„ãªä¼šè©±è¡¨ç¾

##### 5. ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä¸–ç•Œæ§‹ç¯‰ï¼ˆcampaignWorldBuilderï¼‰
- **å½¹å‰²**: TRPGã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã®ä¸–ç•Œè¦³æ§‹ç¯‰
- **ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: åœ°ç†ã€æ”¿æ²»ã€æ–‡åŒ–ã€æ­´å²ã®è¨­å®šã¨ãƒ—ãƒ¬ã‚¤ã¸ã®å½±éŸ¿ã‚’è€ƒæ…®ã—ãŸææ¡ˆ

##### 6. ğŸ® AIãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ï¼ˆaiPartyMemberControllerï¼‰
- **å½¹å‰²**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä¸è¶³æ™‚ã«PCã‚’æ“ä½œã™ã‚‹AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
- **ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®æ€§æ ¼ãƒ»èƒŒæ™¯ã«å¿ å®Ÿã«è¡Œå‹•ã—ã€äººé–“ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ç«‹ã¦ã‚‹
- **æ©Ÿèƒ½**:
  - ã‚·ãƒ³ã‚°ãƒ«ãƒ—ãƒ¬ã‚¤æ™‚ã€éé¸æŠPCã‚’è‡ªå‹•æ“ä½œ
  - ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤æ™‚ã€ä¸è¶³äººæ•°åˆ†ã®PCã‚’ä»£ç†æ“ä½œ
  - æˆ¦é—˜ãƒ»éæˆ¦é—˜ä¸¡æ–¹ã®é©åˆ‡ãªè¡Œå‹•é¸æŠ
  - ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã®ç”Ÿå­˜ã¨ç›®æ¨™é”æˆã‚’å„ªå…ˆ
  - GMè¦–ç‚¹ã®æƒ…å ±ã¯ä½¿ç”¨ã—ãªã„ï¼ˆãƒ¡ã‚¿ã‚²ãƒ¼ãƒŸãƒ³ã‚°é˜²æ­¢ï¼‰
- **å‡ºåŠ›å½¢å¼**: ã€Œ[ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å]ã¯[è¡Œå‹•]ã—ã¾ã™ã€+ ç°¡æ½”ãªç†ç”±ã‚„å°è©

##### 7. âš”ï¸ ã‚¨ãƒãƒŸãƒ¼AIã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ï¼ˆenemyAIControllerï¼‰
- **å½¹å‰²**: ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã‚„ã‚¨ãƒãƒŸãƒ¼ã®æˆ¦è¡“çš„è¡Œå‹•ã‚’åˆ¶å¾¡
- **ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: çŸ¥èƒ½ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸé©åˆ‡ãªæˆ¦è¡“é¸æŠã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«é©åº¦ãªæŒ‘æˆ¦ã‚’æä¾›
- **çŸ¥èƒ½ãƒ¬ãƒ™ãƒ«åˆ¥è¡Œå‹•**:
  - ä½çŸ¥èƒ½ï¼ˆé‡ç£ç­‰ï¼‰: æœ¬èƒ½çš„ãƒ»å˜ç´”ãªè¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³
  - ä¸­çŸ¥èƒ½ï¼ˆã‚´ãƒ–ãƒªãƒ³ç­‰ï¼‰: åŸºæœ¬æˆ¦è¡“ç†è§£ã€å¼±ã£ãŸæ•µå„ªå…ˆ
  - é«˜çŸ¥èƒ½ï¼ˆãƒ‰ãƒ©ã‚´ãƒ³ç­‰ï¼‰: é«˜åº¦ãªæˆ¦è¡“ã€å¼±ç‚¹åˆ†æã€ç½ ä½¿ç”¨
- **å‡ºåŠ›å½¢å¼**: ã€Œ[ã‚¨ãƒãƒŸãƒ¼å]ã¯[è¡Œå‹•]ã‚’å®Ÿè¡Œï¼ã€+ åŠ¹æœéŸ³ã‚„æå†™

##### 8. ğŸ¤ AIå”èª¿è¡Œå‹•ã‚³ãƒ¼ãƒ‡ã‚£ãƒãƒ¼ã‚¿ãƒ¼ï¼ˆaiCooperationCoordinatorï¼‰
- **å½¹å‰²**: è¤‡æ•°ã®AIåˆ¶å¾¡ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é–“ã®é€£æºã‚’èª¿æ•´
- **ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: è‡ªç„¶ã§æˆ¦è¡“çš„ãªé€£æºã€ä¸è‡ªç„¶ãªå®Œç’§ã•ã‚’é¿ã‘ã‚‹
- **é€£æºãƒ‘ã‚¿ãƒ¼ãƒ³**: æŒŸã¿æ’ƒã¡ã€ã‚³ãƒ³ãƒœæ”»æ’ƒã€å½¹å‰²åˆ†æ‹…ã€æˆ¦è¡“çš„æ’¤é€€

### ğŸ® ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ¢ãƒ¼ãƒ‰åˆ†é›¢ã‚·ã‚¹ãƒ†ãƒ 

#### æ¦‚è¦

AIã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚¹ã‚¿ãƒ¼æ©Ÿèƒ½ã«ãŠã„ã¦ã€**ã‚·ãƒ³ã‚°ãƒ«ãƒ¢ãƒ¼ãƒ‰**ã¨**ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ãƒ¢ãƒ¼ãƒ‰**ã‚’æ˜ç¢ºã«åˆ†é›¢ã—ã€ãã‚Œãã‚Œã«æœ€é©åŒ–ã•ã‚ŒãŸ TRPG ä½“é¨“ã‚’æä¾›ã—ã¾ã™ã€‚

#### ãƒ¢ãƒ¼ãƒ‰é¸æŠãƒ•ãƒ­ãƒ¼

```mermaid
flowchart TD
    A[TRPGã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹] --> B{AIã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚¹ã‚¿ãƒ¼}
    B -->|æœ‰åŠ¹| C[ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ¢ãƒ¼ãƒ‰é¸æŠ]
    B -->|ç„¡åŠ¹| D[æ‰‹å‹•GMãƒ¢ãƒ¼ãƒ‰]
    
    C --> E[ã‚·ãƒ³ã‚°ãƒ«ãƒ¢ãƒ¼ãƒ‰]
    C --> F[ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ãƒ¢ãƒ¼ãƒ‰]
    
    E --> G[ä¸€äººãƒ—ãƒ¬ã‚¤å°‚ç”¨ã‚»ãƒƒã‚·ãƒ§ãƒ³]
    F --> H[å”åŠ›ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ã‚»ãƒƒã‚·ãƒ§ãƒ³]
    
    style E fill:#e1f5fe
    style F fill:#f3e5f5
    style G fill:#c8e6c9
    style H fill:#c8e6c9
```

#### ã‚·ãƒ³ã‚°ãƒ«ãƒ¢ãƒ¼ãƒ‰ä»•æ§˜

**ç‰¹å¾´**:
- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1äººå°‚ç”¨ã‚»ãƒƒã‚·ãƒ§ãƒ³
- ä»–ã®å…¨ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’AIãŒè‡ªå‹•æ“ä½œ
- ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆä»–è€…å‚åŠ ä¸å¯ï¼‰
- ã„ã¤ã§ã‚‚ä¸­æ–­ãƒ»å†é–‹å¯èƒ½

**å®Ÿè£…è©³ç´°**:
```typescript
interface SingleModeSession {
  mode: 'single';
  maxPlayers: 1;
  isPrivate: true;
  aiControlledCharacters: TRPGCharacter[]; // AIæ“ä½œã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
  playerCharacter: TRPGCharacter; // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ“ä½œã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
  pauseSupport: boolean; // ä¸€æ™‚åœæ­¢æ©Ÿèƒ½
}
```

**AIå‹•ä½œ**:
- ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼ã®æˆ¦è¡“çš„åˆ¤æ–­
- è‡ªç„¶ãªä¼šè©±ãƒ»ç›¸äº’ä½œç”¨
- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ„å›³ã‚’æ±²ã‚“ã æ”¯æ´è¡Œå‹•
- ã‚²ãƒ¼ãƒ é€²è¡Œã®è‡ªå‹•ç®¡ç†

#### ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ãƒ¢ãƒ¼ãƒ‰ä»•æ§˜

**ç‰¹å¾´**:
- 2-6äººã®å”åŠ›ãƒ—ãƒ¬ã‚¤
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸæ©Ÿèƒ½
- ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ»ãƒ‘ãƒ–ãƒªãƒƒã‚¯é¸æŠå¯èƒ½
- æ‹›å¾…ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹å‚åŠ åˆ¶å¾¡

**å®Ÿè£…è©³ç´°**:
```typescript
interface MultiplayerModeSession {
  mode: 'multiplayer';
  maxPlayers: number; // 2-6
  isPrivate: boolean;
  inviteCode?: string;
  realTimeSync: {
    chat: boolean;
    diceRolls: boolean;
    gameState: boolean;
    characterActions: boolean;
  };
}
```

**Socket.IOé€šä¿¡**:
- `create_session`: ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆï¼ˆãƒ¢ãƒ¼ãƒ‰æŒ‡å®šï¼‰
- `join_session`: ã‚»ãƒƒã‚·ãƒ§ãƒ³å‚åŠ ï¼ˆæ‹›å¾…ã‚³ãƒ¼ãƒ‰ï¼‰
- `chat_message`: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ£ãƒƒãƒˆ
- `dice_roll`: åŒæœŸãƒ€ã‚¤ã‚¹ãƒ­ãƒ¼ãƒ«
- `game_state_update`: ã‚²ãƒ¼ãƒ çŠ¶æ…‹åŒæœŸ

#### æŠ€è¡“å®Ÿè£…

**ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**:
- `SessionModeSelector.tsx`: ãƒ¢ãƒ¼ãƒ‰é¸æŠUI
- `SocketService.ts`: Socket.IO ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹ç®¡ç†

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**:
- `socket.service.ts`: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã‚µãƒ¼ãƒãƒ¼
- ãƒ¢ãƒ¼ãƒ‰åˆ¥ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ¶å¾¡
- æ‹›å¾…ã‚³ãƒ¼ãƒ‰ç®¡ç†
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡å‡¦ç†

#### å‰µä½œæ”¯æ´ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

- **å½¹å‰²**: ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨­è¨ˆæ”¯æ´
- **å®Ÿè£…ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: scenarioDesigner, trpgCharacterCreator, campaignWorldBuilder
- **æ©Ÿèƒ½**:
  - ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ»æ•µãƒ»NPC ç”Ÿæˆ
  - ã‚¯ã‚¨ã‚¹ãƒˆãƒ»ã‚¨ãƒ³ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ç”Ÿæˆ
  - ä¸–ç•Œè¦³è¨­å®šæ”¯æ´
  - ã‚·ãƒŠãƒªã‚ªãƒãƒ©ãƒ³ã‚¹èª¿æ•´ææ¡ˆ

#### ç”»åƒç”Ÿæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

- **æŠ€è¡“**: Google Imagen 3 + Vertex AI
- **æ©Ÿèƒ½**:
  - ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¤ãƒ¡ãƒ¼ã‚¸ç”Ÿæˆ
  - æ‹ ç‚¹ãƒ»èƒŒæ™¯ç”»åƒç”Ÿæˆ
  - ã‚³ã‚¹ãƒˆæœ€é©åŒ–ï¼ˆ$0.03/ç”»åƒï¼‰

### ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

#### GM ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

```
ã‚ãªãŸã¯TRPGã®ã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ã§ã™ã€‚ä»¥ä¸‹ã®è¨­å®šã§ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é€²è¡Œã—ã¦ãã ã•ã„ï¼š

ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨­å®šï¼š{campaign.synopsis}
ç¾åœ¨ã®çŠ¶æ³ï¼š{currentSituation}
å‚åŠ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ï¼š{characters}
ç¾åœ¨åœ°ï¼š{currentLocation}

ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è¡Œå‹•ã«å¯¾ã—ã¦ã€ä»¥ä¸‹ã‚’è€ƒæ…®ã—ã¦å¿œç­”ã—ã¦ãã ã•ã„ï¼š
1. ä¸–ç•Œè¦³ã®ä¸€è²«æ€§ã‚’ä¿ã¤
2. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é¸æŠã‚’å°Šé‡ã™ã‚‹
3. é©åº¦ãªå›°é›£ã¨é”æˆæ„Ÿã‚’æä¾›ã™ã‚‹
4. å¿…è¦ã«å¿œã˜ã¦ãƒ€ã‚¤ã‚¹ãƒ­ãƒ¼ãƒ«ã‚„ã‚¹ã‚­ãƒ«ãƒã‚§ãƒƒã‚¯ã‚’ææ¡ˆã™ã‚‹
```

## æŠ€è¡“å®Ÿè£…è©³ç´°

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **React 18**: ãƒ¡ã‚¤ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **TypeScript**: å‹å®‰å…¨æ€§
- **Material-UI v5**: UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **Recoil**: çŠ¶æ…‹ç®¡ç†
- **React Router v7**: ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- **Slate.js**: ãƒªãƒƒãƒãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒãƒ¼ãƒˆç”¨ï¼‰

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **Express.js**: API ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **TypeScript**: å‹å®‰å…¨æ€§
- **SQLite + Litestream**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
- **Socket.IO**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡
- **Passport.js**: èªè¨¼
- **Multer**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- **Google Cloud Storage**: ç”»åƒä¿å­˜

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

#### ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«

```sql
-- ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³
CREATE TABLE campaigns (
  id TEXT PRIMARY KEY,
  title TEXT NOT NULL,
  synopsis TEXT,
  game_system TEXT,
  max_players INTEGER,
  world_building TEXT, -- JSON
  image_url TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
CREATE TABLE characters (
  id TEXT PRIMARY KEY,
  campaign_id TEXT,
  name TEXT NOT NULL,
  character_type TEXT CHECK(character_type IN ('PC', 'NPC')),
  character_data TEXT, -- JSON (attributes, skills, etc.)
  image_url TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (campaign_id) REFERENCES campaigns(id)
);

-- æ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼
CREATE TABLE enemies (
  id TEXT PRIMARY KEY,
  campaign_id TEXT,
  name TEXT NOT NULL,
  rank TEXT CHECK(rank IN ('ãƒ¢ãƒ–', 'ä¸­ãƒœã‚¹', 'ãƒœã‚¹', 'EXãƒœã‚¹')),
  enemy_data TEXT, -- JSON
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (campaign_id) REFERENCES campaigns(id)
);

-- æ‹ ç‚¹
CREATE TABLE bases (
  id TEXT PRIMARY KEY,
  campaign_id TEXT,
  name TEXT NOT NULL,
  base_data TEXT, -- JSON
  image_url TEXT,
  unlocked BOOLEAN DEFAULT FALSE,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (campaign_id) REFERENCES campaigns(id)
);

-- ã‚»ãƒƒã‚·ãƒ§ãƒ³
CREATE TABLE sessions (
  id TEXT PRIMARY KEY,
  campaign_id TEXT,
  session_number INTEGER,
  title TEXT,
  session_data TEXT, -- JSON
  recording_url TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (campaign_id) REFERENCES campaigns(id)
);
```

### API è¨­è¨ˆ

#### ä¸»è¦ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

##### ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç®¡ç†

```
GET    /api/campaigns          # ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä¸€è¦§
POST   /api/campaigns          # æ–°è¦ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä½œæˆ
GET    /api/campaigns/:id      # ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è©³ç´°
PUT    /api/campaigns/:id      # ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æ›´æ–°
DELETE /api/campaigns/:id      # ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å‰Šé™¤
```

##### ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç®¡ç†

```
GET    /api/campaigns/:id/characters     # ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä¸€è¦§
POST   /api/campaigns/:id/characters     # æ–°è¦ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä½œæˆ
PUT    /api/characters/:id               # ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æ›´æ–°
DELETE /api/characters/:id               # ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å‰Šé™¤
```

##### AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

###### ä¸–ç•Œè¦³æ§‹ç¯‰é–¢é€£
```
POST   /api/ai-agent/worldbuilding-detail-generation    # ä¸–ç•Œè¦³è¦ç´ è©³ç´°ç”Ÿæˆ
POST   /api/ai-agent/worldbuilding-list-generation      # ä¸–ç•Œè¦³è¦ç´ ãƒªã‚¹ãƒˆç”Ÿæˆ
POST   /api/ai-agent/worldbuilding-context-generation   # ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆèªè­˜å‹ä¸–ç•Œè¦³ç”Ÿæˆï¼ˆğŸŒ WorldContextBuilderçµ±åˆï¼‰
```

###### ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ»ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ç”Ÿæˆ
```
POST   /api/ai-agent/character-generation    # ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”Ÿæˆï¼ˆtrpgCharacterCreatorä½¿ç”¨ï¼‰
POST   /api/ai-agent/enemy-generation        # æ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”Ÿæˆ
POST   /api/ai-agent/npc-generation          # NPCç”Ÿæˆ
POST   /api/ai-agent/quest-generation        # ã‚¯ã‚¨ã‚¹ãƒˆç”Ÿæˆï¼ˆscenarioDesignerä½¿ç”¨ï¼‰
```

###### ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Ÿè¡Œæ”¯æ´
```
POST   /api/ai-agent/session-gm-assist       # GMã‚¢ã‚·ã‚¹ãƒˆï¼ˆtrpgGameMasterä½¿ç”¨ï¼‰
POST   /api/ai-agent/plot-advice            # ãƒ—ãƒ­ãƒƒãƒˆã‚¢ãƒ‰ãƒã‚¤ã‚¹ï¼ˆscenarioDesignerä½¿ç”¨ï¼‰
POST   /api/ai-agent/timeline-event-generation # ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆç”Ÿæˆ
POST   /api/ai-agent/chapter-generation      # ç« æœ¬æ–‡ç”Ÿæˆï¼ˆsessionNarratorä½¿ç”¨ï¼‰
```

###### AIåˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ï¼ˆæœªå®Ÿè£…ãƒ»æ¬¡æœŸå®Ÿè£…äºˆå®šï¼‰
```
POST   /api/ai-agent/ai-party-member-action  # AIãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼è¡Œå‹•æ±ºå®šï¼ˆaiPartyMemberControllerä½¿ç”¨ï¼‰
POST   /api/ai-agent/enemy-ai-action         # ã‚¨ãƒãƒŸãƒ¼AIè¡Œå‹•æ±ºå®šï¼ˆenemyAIControllerä½¿ç”¨ï¼‰
POST   /api/ai-agent/ai-coordination         # AIé€£æºè¡Œå‹•èª¿æ•´ï¼ˆaiCooperationCoordinatorä½¿ç”¨ï¼‰
POST   /api/ai-agent/forced-dice-roll        # AIåˆ¶å¾¡ãƒ€ã‚¤ã‚¹ãƒ­ãƒ¼ãƒ«è¦æ±‚
POST   /api/ai-agent/encounter-detection     # ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³é­é‡åˆ¤å®š
POST   /api/ai-agent/tactical-analysis       # æˆ¦è¡“åˆ¤æ–­åˆ†æ
```

###### ç”»åƒç”Ÿæˆ
```
POST   /api/ai-agent/character-image-gen     # ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç”»åƒç”Ÿæˆï¼ˆGoogle Imagen 3ï¼‰
POST   /api/ai-agent/base-image-gen          # æ‹ ç‚¹ç”»åƒç”Ÿæˆï¼ˆGoogle Imagen 3ï¼‰
```

###### ãã®ä»–ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
```
POST   /api/ai-agent/test-connection         # AIæ¥ç¶šãƒ†ã‚¹ãƒˆ
POST   /api/ai-agent/test-key                # APIã‚­ãƒ¼ãƒ†ã‚¹ãƒˆ
```

##### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ï¼ˆSocket.IOï¼‰

```
session:join              # ã‚»ãƒƒã‚·ãƒ§ãƒ³å‚åŠ 
session:leave             # ã‚»ãƒƒã‚·ãƒ§ãƒ³é›¢è„±
session:chat              # ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
session:action            # ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¡Œå‹•
session:gm-response       # GMå¿œç­”
session:dice-roll         # é€šå¸¸ãƒ€ã‚¤ã‚¹ãƒ­ãƒ¼ãƒ«
session:ai-forced-dice    # AIåˆ¶å¾¡å¼·åˆ¶ãƒ€ã‚¤ã‚¹ãƒ­ãƒ¼ãƒ«
session:encounter-alert   # é­é‡ç™ºç”Ÿé€šçŸ¥
session:tactical-request  # æˆ¦è¡“åˆ¤å®šè¦æ±‚
session:status-update     # ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
```

## ğŸ² AIåˆ¶å¾¡ãƒ€ã‚¤ã‚¹ã‚·ã‚¹ãƒ†ãƒ æŠ€è¡“ä»•æ§˜

### ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒæˆ¦è¡“çš„åˆ¤æ–­ã«åŸºã¥ã„ã¦ãƒ€ã‚¤ã‚¹ãƒ­ãƒ¼ãƒ«ã‚’å¼·åˆ¶è¦æ±‚ã—ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæŒ‡å®šã•ã‚ŒãŸãƒ€ã‚¤ã‚¹ã‚’æ­£ç¢ºã«æŒ¯ã‚‹ã¾ã§ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒé–‰ã˜ãªã„ä»•çµ„ã¿ã€‚ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ãƒ™ãƒ¼ã‚¹ã®é­é‡ã‚·ã‚¹ãƒ†ãƒ ã¨é€£å‹•ã—ã€ã‚¨ãƒãƒŸãƒ¼ã®æ„å›³ã«ã‚ˆã‚‹ãƒ€ã‚¤ã‚¹ãƒ­ãƒ¼ãƒ«ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

### æ ¸å¿ƒæŠ€è¡“è¦ä»¶

#### 1. å¼·åˆ¶ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ 

```typescript
interface AIForcedDiceDialog {
  // AIæŒ‡å®šãƒ€ã‚¤ã‚¹ä»•æ§˜
  requiredDice: {
    diceType: string;     // "d20", "d6", "d12" ãªã©
    count: number;        // ãƒ€ã‚¤ã‚¹å€‹æ•°
    modifier: number;     // ä¿®æ­£å€¤
    characterStat?: string; // èƒ½åŠ›å€¤å‚ç…§
  };
  
  // å¼·åˆ¶åˆ¶å¾¡ãƒ•ãƒ©ã‚°
  forcedMode: true;
  preventClose: true;
  preventEscape: true;
  preventClickAway: true;
  
  // æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ 
  validationEngine: DiceValidationEngine;
  onValidationFailed: (error: ValidationError) => void;
  onValidationSuccess: (result: DiceResult) => void;
}
```

#### 2. ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¡çªåˆ¤å®šã‚¨ãƒ³ã‚¸ãƒ³

```typescript
interface EncounterDetectionEngine {
  // ç©ºé–“ãƒ»æ™‚é–“è§£æ
  analyzeSpatialTemporal(): {
    playerPositions: Position[];
    enemyPositions: Position[];
    collisionDetected: boolean;
    collisionType: "ambush" | "patrol" | "trap" | "random";
  };
  
  // AIæˆ¦è¡“åˆ¤æ–­
  executeAITacticalAnalysis(): {
    initiativeOrder: string[];
    surpriseRound: boolean;
    requiredChecks: DiceCheckRequirement[];
    tacticalAdvantage: "player" | "enemy" | "neutral";
  };
  
  // é­é‡ãƒ•ãƒ­ãƒ¼åˆ¶å¾¡
  triggerEncounterSequence(): EncounterFlow;
}
```

#### 3. ãƒ€ã‚¤ã‚¹æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ 

```typescript
class DiceValidationEngine {
  validateDiceRoll(
    rolled: DiceResult, 
    required: DiceSpecification
  ): ValidationResult {
    // 1. ãƒ€ã‚¤ã‚¹ç¨®é¡ã®æ¤œè¨¼
    if (rolled.diceType !== required.diceType) {
      return {
        valid: false,
        error: `AIãŒæŒ‡å®šã—ãŸ${required.diceType}ã‚’æŒ¯ã£ã¦ãã ã•ã„`
      };
    }
    
    // 2. ãƒ€ã‚¤ã‚¹å€‹æ•°ã®æ¤œè¨¼
    if (rolled.diceCount !== required.count) {
      return {
        valid: false,
        error: `${required.count}å€‹ã®${required.diceType}ã‚’æŒ¯ã£ã¦ãã ã•ã„`
      };
    }
    
    // 3. ä¿®æ­£å€¤ã®æ¤œè¨¼
    if (rolled.modifier !== required.modifier) {
      return {
        valid: false,
        error: `ä¿®æ­£å€¤${required.modifier}ã‚’é©ç”¨ã—ã¦ãã ã•ã„`
      };
    }
    
    return { valid: true, result: rolled };
  }
}
```

### é­é‡ç™ºç”Ÿãƒ•ãƒ­ãƒ¼

#### Phase 1: è¡çªæ¤œå‡º
1. ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³é€²è¡Œç›£è¦–
2. PCä½ç½®ãƒ»ã‚¨ãƒãƒŸãƒ¼ä½ç½®ã®ç¶™ç¶šçš„ãƒã‚§ãƒƒã‚¯
3. åŒä¸€æ™‚ç©ºé–“ã§ã®è¡çªæ¤œå‡º

#### Phase 2: AIæˆ¦è¡“åˆ†æ
1. é­é‡çŠ¶æ³ã®è©³ç´°åˆ†æï¼ˆåœ°å½¢ã€äººæ•°ã€èƒ½åŠ›å€¤ï¼‰
2. æœ€é©ãªåˆ¤å®šæ–¹æ³•ã®æ±ºå®š
3. ã‚µãƒ—ãƒ©ã‚¤ã‚ºãƒ»å…ˆåˆ¶æ”»æ’ƒã®å¯èƒ½æ€§è©•ä¾¡

#### Phase 3: å¼·åˆ¶ãƒ€ã‚¤ã‚¹è¦æ±‚
1. AIåˆ¶å¾¡ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®å¼·åˆ¶è¡¨ç¤º
2. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¸ã®å…·ä½“çš„æŒ‡ç¤ºè¡¨ç¤º
3. å…¨UIæ“ä½œã®ç„¡åŠ¹åŒ–ï¼ˆãƒ€ã‚¤ã‚¹ãƒ­ãƒ¼ãƒ«ä»¥å¤–ï¼‰

#### Phase 4: çµæœåˆ¤å®šãƒ»åæ˜ 
1. ãƒ€ã‚¤ã‚¹çµæœã®æˆ¦è¡“çš„è§£é‡ˆ
2. é­é‡çµæœã®ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³åæ˜ 
3. æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºã¸ã®ç§»è¡Œ

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ã‚¤ãƒ³ãƒ†ã‚°ãƒªãƒ†ã‚£

#### ä¸æ­£æ“ä½œé˜²æ­¢
- ãƒ–ãƒ©ã‚¦ã‚¶é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã‚‹çµæœæ“ä½œæ¤œå‡º
- ç•°å¸¸ãªç¢ºç‡ãƒ‘ã‚¿ãƒ¼ãƒ³ã®çµ±è¨ˆçš„æ¤œå‡º
- ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§ã®äºŒé‡æ¤œè¨¼

#### å…¬å¹³æ€§ä¿è¨¼
- AIã®åˆ¤æ–­åŸºæº–ã®é€æ˜æ€§
- ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ«ã«åŸºã¥ã„ãŸå³å¯†ãªåˆ¤å®š
- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼èƒ½åŠ›å€¤ã®æ­£ç¢ºãªåæ˜ 

### å®Ÿè£…å„ªå…ˆåº¦

**CRITICAL (å³åº§å®Ÿè£…)**
- å¼·åˆ¶ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- åŸºæœ¬çš„ãªãƒ€ã‚¤ã‚¹æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ 
- ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¡çªåˆ¤å®š

**HIGH (1-2é€±é–“)**
- AIæˆ¦è¡“åˆ¤æ–­ã‚¨ãƒ³ã‚¸ãƒ³
- ã‚¨ãƒãƒŸãƒ¼è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³AI
- Socket.IO ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡

**MEDIUM (1ãƒ¶æœˆ)**
- é«˜åº¦ãªçµ±è¨ˆçš„åˆ†æ
- æˆ¦è¡“çš„ãƒãƒ©ãƒ³ã‚¹èª¿æ•´
- ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£æ”¹å–„

## ğŸŒ ä¸–ç•Œè¦³æ§‹ç¯‰çµ±åˆã‚·ã‚¹ãƒ†ãƒ 

### çµ±åˆãƒ“ã‚¸ãƒ§ãƒ³

ä¸–ç•Œè¦³æ§‹ç¯‰ãƒ‡ãƒ¼ã‚¿ã‚’å˜ãªã‚‹è¨­å®šè³‡æ–™ã§ã¯ãªãã€å®Ÿéš›ã®ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ã«ç›´æ¥å½±éŸ¿ã‚’ä¸ãˆã‚‹ã€Œç”ŸããŸãƒ‡ãƒ¼ã‚¿ã€ã¨ã—ã¦æ´»ç”¨ã—ã¾ã™ã€‚ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå…¥åŠ›ã—ãŸå…¨ã¦ã®ä¸–ç•Œè¦³æƒ…å ±ãŒã€AIã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ã®åˆ¤æ–­åŸºæº–ã¨ãªã‚Šã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½“é¨“ã‚’è±Šã‹ã«ã—ã¾ã™ã€‚

### å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º

#### Phase 1: æ‹ ç‚¹ãƒ‡ãƒ¼ã‚¿çµ±åˆï¼ˆ1é€±é–“ï¼‰

```typescript
// TRPGSessionPageã§ã®æ‹ ç‚¹ãƒ‡ãƒ¼ã‚¿å®Œå…¨æ´»ç”¨
const handleLocationChange = (newLocation: string) => {
  const base = bases.find(b => b.name === newLocation);
  if (base) {
    // æ–½è¨­ã®è‡ªå‹•è¡¨ç¤º
    setAvailableServices(base.facilities);
    // NPCã®è‡ªå‹•é…ç½®
    setLocationNPCs(base.npcs);
    // æ–‡åŒ–çš„ä¿®æ­£å€¤ã®é©ç”¨
    applyCulturalModifiers(base.culturalModifiers);
    // é­é‡ãƒã‚§ãƒƒã‚¯
    checkForEncounters(base);
  }
};
```

**å®Ÿè£…é …ç›®**ï¼š
- [ ] BaseLocationå‹ã®æ‹¡å¼µï¼ˆencounterRules, npcSchedule, culturalModifiersè¿½åŠ ï¼‰
- [ ] TRPGSessionPageã§ã®æ‹ ç‚¹ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ãƒ»é©ç”¨
- [ ] å ´æ‰€ç§»å‹•æ™‚ã®è‡ªå‹•å‡¦ç†ãƒ•ãƒ­ãƒ¼
- [ ] æ–½è¨­åˆ©ç”¨UIã®å‹•çš„ç”Ÿæˆ

#### Phase 2: ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒãƒƒãƒ—UIï¼ˆ2-3é€±é–“ï¼‰

```typescript
// ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ¯ãƒ¼ãƒ«ãƒ‰ãƒãƒƒãƒ—ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
<InteractiveWorldMap
  locations={worldBuilding.bases}
  currentPartyLocation={currentLocation}
  onLocationClick={(location) => {
    showLocationDetails(location);
    calculateTravelRoute(currentLocation, location);
    displayEncounterProbability(location);
  }}
  overlays={{
    dangerLevel: true,
    questMarkers: true,
    npcLocations: true,
    partyPosition: true,
  }}
/>
```

**å®Ÿè£…é …ç›®**ï¼š
- [ ] react-leafletã¾ãŸã¯react-simple-mapsã®å°å…¥
- [ ] ã‚«ã‚¹ã‚¿ãƒ ãƒãƒƒãƒ—ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®é–‹ç™º
- [ ] å ´æ‰€ãƒãƒ¼ã‚«ãƒ¼ãƒ»ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè£…
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä½ç½®è¿½è·¡ã‚·ã‚¹ãƒ†ãƒ 
- [ ] ç§»å‹•ãƒ«ãƒ¼ãƒˆè¨ˆç®—ãƒ»è¡¨ç¤ºæ©Ÿèƒ½

#### Phase 3: AIçµ±åˆï¼ˆ2é€±é–“ï¼‰

```typescript
// AIç”¨ä¸–ç•Œè¦³ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ“ãƒ«ãƒ€ãƒ¼
class WorldContextBuilder {
  static buildForLocation(location: Base, worldData: WorldBuilding): AIContext {
    return {
      // å ´æ‰€å›ºæœ‰ã®æƒ…å ±
      location: {
        name: location.name,
        description: location.description,
        facilities: location.facilities,
        dangers: location.threats,
      },
      
      // æ–‡åŒ–ãƒ»æ­´å²ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
      cultural: {
        dominantCulture: worldData.cultures.find(c => c.regions.includes(location.id)),
        historicalEvents: worldData.history.filter(h => h.locations.includes(location.id)),
        localCustoms: location.culturalModifiers,
      },
      
      // ç’°å¢ƒè¦å› 
      environmental: {
        climate: location.climate,
        currentWeather: WeatherSystem.getWeather(location),
        timeOfDay: TimeSystem.getCurrentTime(),
        season: TimeSystem.getCurrentSeason(),
      },
      
      // ã‚²ãƒ¼ãƒ ãƒ¡ã‚«ãƒ‹ã‚¯ã‚¹ä¿®æ­£å€¤
      mechanics: {
        priceModifier: location.culturalModifiers.priceModifier,
        negotiationDC: location.culturalModifiers.negotiationDC,
        encounterChance: location.encounterRules[TimeSystem.getCurrentTime()],
      },
    };
  }
}
```

**å®Ÿè£…é …ç›®**ï¼š
- [ ] WorldContextBuilderã‚¯ãƒ©ã‚¹ã®å®Ÿè£…
- [ ] AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆAPIã¸ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆçµ±åˆ
- [ ] å ´æ‰€åˆ¥AIå¿œç­”ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
- [ ] ç’°å¢ƒè¦å› ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…

### æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ

1. **æ²¡å…¥æ„Ÿã®å‘ä¸Š**: ä¸–ç•Œè¦³è¨­å®šãŒå®Ÿéš›ã®ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ã«åæ˜ ã•ã‚Œã€ã‚ˆã‚Šæ·±ã„æ²¡å…¥æ„Ÿã‚’æä¾›
2. **AIã®è³ªå‘ä¸Š**: è±Šå¯Œãªã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ã‚ˆã‚ŠAIãŒã‚ˆã‚Šé©åˆ‡ã§ä¸–ç•Œè¦³ã«åˆã£ãŸå¿œç­”ã‚’ç”Ÿæˆ
3. **ãƒ—ãƒ¬ã‚¤ã®å¤šæ§˜æ€§**: å ´æ‰€ã”ã¨ã®ç‰¹è‰²ã«ã‚ˆã‚Šã€åŒã˜ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã§ã‚‚ç•°ãªã‚‹ä½“é¨“ãŒå¯èƒ½
4. **è¨­å®šä½œæ¥­ã®ä¾¡å€¤å‘ä¸Š**: å…¥åŠ›ã—ãŸä¸–ç•Œè¦³ãƒ‡ãƒ¼ã‚¿ãŒç„¡é§„ã«ãªã‚‰ãšã€å®Ÿéš›ã®ãƒ—ãƒ¬ã‚¤ä½“é¨“ã‚’è±Šã‹ã«ã™ã‚‹

### æŠ€è¡“çš„å®Ÿè£…è©³ç´°

#### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```mermaid
flowchart LR
    A[ä¸–ç•Œè¦³æ§‹ç¯‰ç”»é¢] --> B[(ä¸–ç•Œè¦³ãƒ‡ãƒ¼ã‚¿)]
    B --> C[ã‚»ãƒƒã‚·ãƒ§ãƒ³ç”»é¢]
    C --> D[AIã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ]
    D --> E[AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ]
    E --> F[ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸå¿œç­”]
    
    B --> G[ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒãƒƒãƒ—]
    G --> H[è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯]
    
    C --> I[é­é‡ã‚·ã‚¹ãƒ†ãƒ ]
    I --> J[å ´æ‰€åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿ]
    
    style A fill:#e3f2fd
    style F fill:#c8e6c9
    style H fill:#fff3e0
```

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

- **é…å»¶èª­ã¿è¾¼ã¿**: ãƒãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã¯å¿…è¦æ™‚ã®ã¿ãƒ­ãƒ¼ãƒ‰
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥**: è¨ªå•æ¸ˆã¿å ´æ‰€ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- **å·®åˆ†æ›´æ–°**: ä¸–ç•Œè¦³ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›´ã‚’åŠ¹ç‡çš„ã«åæ˜ 

## ğŸ® TRPGã‚»ãƒƒã‚·ãƒ§ãƒ³ç”»é¢ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ãƒ•ãƒ­ãƒ¼

### ã‚»ãƒƒã‚·ãƒ§ãƒ³å…¨ä½“ãƒ•ãƒ­ãƒ¼æ¦‚è¦

TRPGã‚»ãƒƒã‚·ãƒ§ãƒ³ç”»é¢ã§ã¯ã€AIã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ãŒä¸»å°ã™ã‚‹å®Œå…¨è‡ªå‹•åŒ–ã•ã‚ŒãŸTRPGã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ãŒå¯èƒ½ã§ã™ã€‚ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯é¸æŠã™ã‚‹ã ã‘ã§ã€AIãŒçŠ¶æ³ã«å¿œã˜ã¦æœ€é©ãªä½“é¨“ã‚’æä¾›ã—ã¾ã™ã€‚

### ğŸ”„ ãƒ¡ã‚¤ãƒ³ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ãƒ•ãƒ­ãƒ¼

```mermaid
flowchart TD
    A[ã‚»ãƒƒã‚·ãƒ§ãƒ³ç”»é¢ã‚¢ã‚¯ã‚»ã‚¹] --> B{ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³é¸æŠæ¸ˆã¿?}
    B -->|No| C[ãƒ›ãƒ¼ãƒ ç”»é¢ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ]
    B -->|Yes| D[ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆæœŸåŒ–]
    
    D --> E[PCã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è‡ªå‹•é¸æŠ]
    E --> F["ã€ŒAIã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ã«ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ã€ãƒœã‚¿ãƒ³è¡¨ç¤º"]
    F --> G[ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯]
    
    G --> H[AI: ã‚²ãƒ¼ãƒ å°å…¥ãƒ»çŠ¶æ³èª¬æ˜ç”Ÿæˆ]
    H --> I[AI: ç¾åœ¨çŠ¶æ³ã«å¿œã˜ãŸè¡Œå‹•é¸æŠè‚¢ç”Ÿæˆ]
    I --> J[ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«è¡Œå‹•é¸æŠè‚¢è¡¨ç¤º]
    
    J --> K{ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é¸æŠ}
    K -->|è¡Œå‹•é¸æŠ| L[é¸æŠã—ãŸè¡Œå‹•ã‚’å®Ÿè¡Œ]
    K -->|ãƒãƒ£ãƒƒãƒˆå…¥åŠ›| M[è‡ªç”±ç™ºè¨€ã‚’ãƒãƒ£ãƒƒãƒˆã«é€ä¿¡]
    K -->|NPCä¼šè©±| N[NPCé¸æŠâ†’AIä¼šè©±ç”Ÿæˆ]
    
    L --> O[AI: è¡Œå‹•çµæœç”Ÿæˆãƒ»æå†™]
    M --> P[AI: ãƒãƒ£ãƒƒãƒˆå†…å®¹ã«å¿œç­”]
    N --> Q[AI: NPCã¨ã—ã¦è‡ªç„¶ãªä¼šè©±å¿œç­”]
    
    O --> R[AIãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼è‡ªå‹•è¡Œå‹•]
    P --> R
    Q --> R
    
    R --> S[AI: æ—¥é€²è¡Œåˆ¤å®šå®Ÿè¡Œ]
    S --> T{æ—¥é€²è¡ŒãŒå¿…è¦?}
    
    T -->|No| U[æ–°ã—ã„è¡Œå‹•é¸æŠè‚¢ç”Ÿæˆ]
    U --> J
    
    T -->|Yes| V[æ¬¡ã®æ—¥ã¸é€²è¡Œ]
    V --> W[è¡Œå‹•å›æ•°ãƒªã‚»ãƒƒãƒˆ]
    W --> X{æœ€çµ‚æ—¥åˆ°é”?}
    
    X -->|No| Y[æ–°ã—ã„æ—¥ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒã‚§ãƒƒã‚¯]
    Y --> Z[ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³é€£å‹•ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿ]
    Z --> I
    
    X -->|Yes| AA[AI: ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å®Œäº†åˆ¤å®š]
    AA --> BB[æˆåŠŸãƒ»å¤±æ•—ãƒ»ã‚¹ã‚³ã‚¢è¡¨ç¤º]
    BB --> CC[ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†]
    
    style A fill:#e1f5fe
    style CC fill:#c8e6c9
    style H fill:#fff3e0
    style I fill:#f3e5f5
    style AA fill:#fce4ec
```

### ğŸ¯ AIã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼å‹•ä½œãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant P as ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼
    participant UI as ã‚»ãƒƒã‚·ãƒ§ãƒ³UI
    participant AI as AIã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼
    participant Party as AIãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼
    participant NPC as NPCã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
    participant Timeline as ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³
    
    Note over P, Timeline: ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹
    P->>UI: ã€ŒAIã«ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹ã—ã¦ã‚‚ã‚‰ã†ã€ã‚¯ãƒªãƒƒã‚¯
    UI->>AI: ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹è¦æ±‚
    AI->>AI: ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æƒ…å ±ãƒ»ç¾åœ¨çŠ¶æ³åˆ†æ
    AI->>UI: ã‚²ãƒ¼ãƒ å°å…¥ãƒ»çŠ¶æ³èª¬æ˜
    
    Note over P, Timeline: è¡Œå‹•ãƒ•ã‚§ãƒ¼ã‚º
    AI->>AI: ç¾åœ¨çŠ¶æ³ã«å¿œã˜ãŸè¡Œå‹•é¸æŠè‚¢ç”Ÿæˆ
    AI->>UI: 3-5å€‹ã®è¡Œå‹•é¸æŠè‚¢è¡¨ç¤º
    UI->>P: è¡Œå‹•é¸æŠè‚¢æç¤º
    
    P->>UI: è¡Œå‹•é¸æŠ OR ãƒãƒ£ãƒƒãƒˆå…¥åŠ›
    UI->>AI: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¡Œå‹•/ç™ºè¨€å†…å®¹
    AI->>AI: è¡Œå‹•çµæœãƒ»å¿œç­”ç”Ÿæˆ
    AI->>UI: è©³ç´°ãªçµæœæå†™
    
    Note over P, Timeline: AIãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼é€£å‹•
    AI->>Party: ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ãƒ¡ãƒ³ãƒãƒ¼è‡ªå‹•è¡Œå‹•ãƒˆãƒªã‚¬ãƒ¼
    Party->>Party: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚‰ã—ã„è¡Œå‹•ãƒ»ç™ºè¨€ç”Ÿæˆ
    Party->>UI: AIã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¡Œå‹•è¡¨ç¤º
    
    Note over P, Timeline: NPCç›¸äº’ä½œç”¨
    alt NPCã¨ã®ä¼šè©±é¸æŠæ™‚
        P->>UI: NPCä¼šè©±é¸æŠ
        UI->>NPC: ä¼šè©±é–‹å§‹è¦æ±‚
        NPC->>NPC: NPCã‚‰ã—ã„å¿œç­”ç”Ÿæˆ
        NPC->>UI: è‡ªç„¶ãªä¼šè©±è¡¨ç¤º
    end
    
    Note over P, Timeline: æ—¥é€²è¡Œåˆ¤å®š
    AI->>AI: è¡Œå‹•å›æ•°ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆå®Œäº†åº¦åˆ†æ
    AI->>Timeline: æ—¥é€²è¡Œå¿…è¦æ€§åˆ¤å®š
    
    alt æ—¥é€²è¡ŒãŒå¿…è¦
        AI->>UI: æ—¥é€²è¡Œç†ç”±è¡¨ç¤º
        Timeline->>Timeline: æ—¥ä»˜æ›´æ–°ãƒ»è¡Œå‹•å›æ•°ãƒªã‚»ãƒƒãƒˆ
        Timeline->>AI: æ–°ã—ã„æ—¥ã®ã‚¤ãƒ™ãƒ³ãƒˆç¢ºèª
        AI->>UI: æ–°æ—¥ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒ»çŠ¶æ³èª¬æ˜
    else ç¶™ç¶š
        AI->>AI: æ–°ã—ã„è¡Œå‹•é¸æŠè‚¢ç”Ÿæˆ
        AI->>UI: æ¬¡ã®è¡Œå‹•é¸æŠè‚¢è¡¨ç¤º
    end
    
    Note over P, Timeline: ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å®Œäº†
    alt æœ€çµ‚æ—¥åˆ°é”
        AI->>AI: ç·åˆçš„ãªã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è©•ä¾¡
        AI->>UI: æˆåŠŸ/å¤±æ•—åˆ¤å®šãƒ»ã‚¹ã‚³ã‚¢ãƒ»ç·è©•è¡¨ç¤º
    end
```

### ğŸ² AIåˆ¶å¾¡ãƒ€ã‚¤ã‚¹çµ±åˆãƒ•ãƒ­ãƒ¼

```mermaid
flowchart LR
    subgraph ã‚»ãƒƒã‚·ãƒ§ãƒ³é€²è¡Œä¸­
        A[ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¡Œå‹•] --> B[AIçµæœç”Ÿæˆ]
        B --> C{ãƒ€ã‚¤ã‚¹åˆ¤å®šå¿…è¦?}
    end
    
    subgraph AIåˆ¶å¾¡ãƒ€ã‚¤ã‚¹
        C -->|Yes| D[AI: å¿…è¦ãƒ€ã‚¤ã‚¹æŒ‡å®š]
        D --> E[å¼·åˆ¶ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º]
        E --> F[ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼: æŒ‡å®šãƒ€ã‚¤ã‚¹å®Ÿè¡Œ]
        F --> G{æ­£ã—ã„ãƒ€ã‚¤ã‚¹?}
        G -->|No| H[ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºãƒ»ç¶™ç¶š]
        H --> F
        G -->|Yes| I[çµæœå—ç†ãƒ»ãƒ€ã‚¤ã‚¢ãƒ­ã‚°é–‰ã˜ã‚‹]
    end
    
    subgraph ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³é€£å‹•
        I --> J[AI: åˆ¤å®šçµæœè§£é‡ˆ]
        J --> K[ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³çŠ¶æ³æ›´æ–°]
        K --> L[æ¬¡ã®çŠ¶æ³ç”Ÿæˆ]
    end
    
    C -->|No| M[é€šå¸¸é€²è¡Œç¶™ç¶š]
    L --> M
    M --> N[æ–°ã—ã„è¡Œå‹•é¸æŠè‚¢ç”Ÿæˆ]
    
    style D fill:#ffeb3b
    style E fill:#ff9800
    style I fill:#4caf50
```

### ğŸ° ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ»NPCç®¡ç†ãƒ•ãƒ­ãƒ¼

```mermaid
flowchart TD
    subgraph ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ“ä½œ
        A[ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠ] --> B[é¸æŠã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã§ã®è¡Œå‹•]
        B --> C[ãƒãƒ£ãƒƒãƒˆãƒ»è¡Œå‹•é¸æŠ]
    end
    
    subgraph AIè‡ªå‹•æ“ä½œ
        D[éé¸æŠã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æ¤œå‡º] --> E[30%ç¢ºç‡ã§è‡ªå‹•è¡Œå‹•]
        E --> F[ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚‰ã—ã„è¡Œå‹•ç”Ÿæˆ]
        F --> G[ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼å†…ç›¸äº’ä½œç”¨]
    end
    
    subgraph NPCè‡ªå‹•å¿œç­”
        H[NPCæ¥è§¦æ¤œå‡º] --> I[NPCæƒ…å ±ãƒ»æ€§æ ¼åˆ†æ]
        I --> J[æ–‡è„ˆã«å¿œã˜ãŸè‡ªç„¶ãªä¼šè©±]
        J --> K[ã‚¯ã‚¨ã‚¹ãƒˆé€²è¡Œãƒã‚§ãƒƒã‚¯]
    end
    
    C --> L[AIå¿œç­”ç”Ÿæˆ]
    G --> L
    K --> L
    L --> M[çµ±åˆã•ã‚ŒãŸä¼šè©±è¡¨ç¤º]
    M --> N[æ¬¡ã®çŠ¶æ³ç”Ÿæˆ]
    
    style F fill:#e8f5e8
    style J fill:#e3f2fd
    style L fill:#fff3e0
```

### ğŸ“… ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†

```mermaid
timeline
    title TRPGã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³é€²è¡Œç®¡ç†
    
    section ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹
        ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³é¸æŠ : æ—¢å­˜ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‹ã‚‰é¸æŠ
        åˆæœŸè¨­å®š : PCã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è‡ªå‹•é¸æŠ
                 : é–‹å§‹å ´æ‰€ãƒ»çŠ¶æ³è¨­å®š
        AIå°å…¥ : ã‚²ãƒ¼ãƒ ä¸–ç•Œã¸ã®å°å…¥
               : èƒŒæ™¯ãƒ»ç›®æ¨™èª¬æ˜
    
    section æ—¥å¸¸ãƒ•ã‚§ãƒ¼ã‚º (1-Næ—¥ç›®)
        è¡Œå‹•é¸æŠ : AIå‹•çš„é¸æŠè‚¢ç”Ÿæˆ
                : ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¡Œå‹•å®Ÿè¡Œ
                : AIãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼è‡ªå‹•è¡Œå‹•
        ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿ : ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³é€£å‹•
                   : NPCé­é‡ãƒ»ä¼šè©±
                   : ãƒ€ã‚¤ã‚¹åˆ¤å®šãƒ»ã‚¹ã‚­ãƒ«ãƒã‚§ãƒƒã‚¯
        æ—¥é€²è¡Œåˆ¤å®š : AIå®Œäº†æ¡ä»¶åˆ†æ
                  : è‡ªå‹•æ—¥é€ã‚Šæ±ºå®š
    
    section æœ€çµ‚ãƒ•ã‚§ãƒ¼ã‚º (æœ€çµ‚æ—¥)
        æœ€çµ‚ã‚¤ãƒ™ãƒ³ãƒˆ : ã‚¯ãƒ©ã‚¤ãƒãƒƒã‚¯ã‚¹å±•é–‹
                   : é‡è¦åˆ¤å®šãƒ»æˆ¦é—˜
        ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³åˆ¤å®š : æˆåŠŸãƒ»å¤±æ•—è©•ä¾¡
                      : ã‚¹ã‚³ã‚¢ãƒ»é”æˆåº¦è¨ˆç®—
        ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº† : ç·è©•ãƒ»æ„Ÿæƒ³è¡¨ç¤º
                     : æ¬¡å›ãƒ—ãƒ¬ã‚¤èª˜å°
```

### ğŸ’¬ ãƒãƒ£ãƒƒãƒˆãƒ»ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä»•æ§˜

**ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—:**
- `player`: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç™ºè¨€
- `gm`: AIã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼å¿œç­”
- `npc`: NPCè‡ªå‹•å¿œç­”
- `system`: ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆæ—¥é€²è¡Œç­‰ï¼‰

**AIå¿œç­”ãƒˆãƒªã‚¬ãƒ¼:**
1. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è‡ªç”±ç™ºè¨€
2. è¡Œå‹•é¸æŠå®Ÿè¡Œ
3. NPCä¼šè©±é¸æŠ
4. ãƒ€ã‚¤ã‚¹åˆ¤å®šçµæœ
5. ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚

**è‡ªå‹•åŒ–ãƒ¬ãƒ™ãƒ«:**
- ğŸ¤– **å®Œå…¨è‡ªå‹•**: AIãŒå…¨ã¦åˆ¤æ–­ãƒ»å®Ÿè¡Œ
- ğŸ¯ **åŠè‡ªå‹•**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼é¸æŠ + AIå¿œç­”
- ğŸ‘¤ **æ‰‹å‹•**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä¸»å°æ“ä½œ

ã“ã®è¨­è¨ˆã«ã‚ˆã‚Šã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯æœ€å°é™ã®æ“ä½œã§AIä¸»å°ã®æœ¬æ ¼çš„ãªTRPGä½“é¨“ã‚’æ¥½ã—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚

## ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆãƒ»é‹ç”¨

### Google Cloud Run æ§‹æˆ

```yaml
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
frontend:
  image: gcr.io/project/trpg-frontend
  port: 3000
  env:
    - REACT_APP_API_URL
    - REACT_APP_SOCKET_URL

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
backend:
  image: gcr.io/project/trpg-backend
  port: 8080
  env:
    - DATABASE_URL
    - OPENAI_API_KEY
    - ANTHROPIC_API_KEY
    - GOOGLE_CLOUD_STORAGE_BUCKET
```

### CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

1. **ã‚³ãƒ¼ãƒ‰å¤‰æ›´æ¤œçŸ¥**: GitHub Push
2. **Cloud Build ãƒˆãƒªã‚¬ãƒ¼**: è‡ªå‹•ãƒ“ãƒ«ãƒ‰é–‹å§‹
3. **Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰**: ãƒãƒ«ãƒã‚¹ãƒ†ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰
4. **Cloud Run ãƒ‡ãƒ—ãƒ­ã‚¤**: Blue-Green ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ
5. **ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯**: APIãƒ»ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç–é€šç¢ºèª

### ç›£è¦–ãƒ»ãƒ­ã‚®ãƒ³ã‚°

- **Cloud Logging**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°
- **Cloud Monitoring**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
- **Error Reporting**: ã‚¨ãƒ©ãƒ¼è¿½è·¡
- **Cloud Trace**: åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»èªè¨¼

### èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 

- **JWT**: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- **Passport.js**: èªè¨¼æˆ¦ç•¥
- **bcryptjs**: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–
- **express-rate-limit**: ãƒ¬ãƒ¼ãƒˆåˆ¶é™

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–

- **Helmet**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼
- **CORS**: ã‚ªãƒªã‚¸ãƒ³åˆ¶é™
- **Input Validation**: Joi ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- **SQL Injection é˜²æ­¢**: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒª

## ä»Šå¾Œã®æ‹¡å¼µè¨ˆç”»

### Phase 1: åŸºæœ¬æ©Ÿèƒ½å®Œæˆ

- ã‚·ãƒ³ã‚°ãƒ«ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ¢ãƒ¼ãƒ‰å®Œæˆ
- åŸºæœ¬çš„ãª AI GM ãƒ•ãƒ«ã‚µãƒãƒ¼ãƒˆ
- ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨­è¨ˆã€œå®Ÿè¡Œã®å®Œå…¨ãƒ•ãƒ­ãƒ¼

### Phase 2: ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å¯¾å¿œ

- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³
- ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãƒ»ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
- ã‚»ãƒƒã‚·ãƒ§ãƒ³å…±æœ‰ãƒ»æ‹›å¾…æ©Ÿèƒ½

### Phase 3: åç›ŠåŒ–ãƒ»ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ 

- **èª²é‡‘ã‚·ã‚¹ãƒ†ãƒ **: ãƒã‚±ãƒƒãƒˆåˆ¶ï¼ˆ1 ãƒ—ãƒ¬ã‚¤ 200 å††æƒ³å®šï¼‰
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”Ÿæˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„**: ã‚·ãƒŠãƒªã‚ªè²©å£²
- **åç›Šåˆ†é…**: ä½œè€…é‚„å…ƒ 60%
- **ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£æ©Ÿèƒ½**: ã‚·ãƒŠãƒªã‚ªå…±æœ‰ãƒ»è©•ä¾¡

### Phase 4: é«˜åº¦ãª AI æ©Ÿèƒ½

- **å‹•çš„ã‚·ãƒŠãƒªã‚ªç”Ÿæˆ**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¡Œå‹•ã«å¿œã˜ãŸãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å±•é–‹
- **éŸ³å£°å¯¾è©±**: éŸ³å£°å…¥åŠ›ãƒ»AI éŸ³å£°åˆæˆ
- **3D è¦–è¦šåŒ–**: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç©ºé–“ã® 3D è¡¨ç¾

## æŠ€è¡“çš„èª²é¡Œã¨è§£æ±ºç­–

### èª²é¡Œ 1: AI å¿œç­”ã®ä¸€è²«æ€§

- **è§£æ±ºç­–**: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè“„ç©ã€ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨˜æ†¶ã‚·ã‚¹ãƒ†ãƒ 
- **æŠ€è¡“**: ãƒ™ã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€RAGï¼ˆRetrieval-Augmented Generationï¼‰

### èª²é¡Œ 2: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§èƒ½

- **è§£æ±ºç­–**: Socket.IO æœ€é©åŒ–ã€çŠ¶æ…‹åŒæœŸã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- **æŠ€è¡“**: Redis ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆã‚¢ã€ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### èª²é¡Œ 3: ã‚³ã‚¹ãƒˆæœ€é©åŒ–

- **è§£æ±ºç­–**: AI API ã‚³ãƒ¼ãƒ«æœ€é©åŒ–ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥
- **æŠ€è¡“**: ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€ãƒãƒƒãƒå‡¦ç†ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†

### é–‹ç™ºä½“åˆ¶

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: React/TypeScript é–‹ç™º
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Node.js/Express é–‹ç™º
- **AI çµ±åˆ**: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°
- **ã‚¤ãƒ³ãƒ•ãƒ©**: Google Cloud é‹ç”¨
- **QA**: E2E ãƒ†ã‚¹ãƒˆãƒ»æ‰‹å‹•ãƒ†ã‚¹ãƒˆ

### å“è³ªä¿è¨¼

- **å˜ä½“ãƒ†ã‚¹ãƒˆ**: Jest + React Testing Library
- **E2E ãƒ†ã‚¹ãƒˆ**: Playwright
- **å‹å®‰å…¨æ€§**: TypeScript strict mode
- **ã‚³ãƒ¼ãƒ‰å“è³ª**: ESLint + Prettier
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: Lighthouse ç›£æŸ»

## ã‚²ãƒ¼ãƒ ä½“é¨“ãƒ•ãƒ­ãƒ¼

### ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å®Ÿè¡Œã®æµã‚Œ

#### 1. ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æº–å‚™ãƒ•ã‚§ãƒ¼ã‚º
- **ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä½œæˆ**: ã‚¿ã‚¤ãƒˆãƒ«ãƒ»æ¦‚è¦ãƒ»ã‚²ãƒ¼ãƒ ã‚·ã‚¹ãƒ†ãƒ é¸æŠ
- **ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¨­å®š**: æœ€å¤§æ—¥æ•°è¨­å®šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ7æ—¥é–“ï¼‰
- **ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç›®çš„è¨­å®š**: æ˜ç¢ºãªé”æˆç›®æ¨™ã®å®šç¾©
- **ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä½œæˆ**: PCãƒ»NPCãƒ»æ•µã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®æº–å‚™
- **ä¸–ç•Œè¦³æ§‹ç¯‰**: æ‹ ç‚¹ãƒ»åœ°ç†ãƒ»ãƒ«ãƒ¼ãƒ«è¨­å®š
- **ã‚¤ãƒ™ãƒ³ãƒˆé…ç½®**: ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ä¸Šã¸ã®é‡è¦ã‚¤ãƒ™ãƒ³ãƒˆé…ç½®

#### 2. ã‚²ãƒ¼ãƒ å®Ÿè¡Œãƒ•ã‚§ãƒ¼ã‚º
- **ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹**: ã€ŒAIã‚²ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ã«ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å§‹ã‚ã¦ã‚‚ã‚‰ã†ã€
- **AIå°å…¥**: ãã®æ—¥ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚„çŠ¶æ³èª¬æ˜
- **ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¡Œå‹•**: ç§»å‹•ãƒ»æ¢ç´¢ãƒ»ä¼šè©±ãƒ»æˆ¦é—˜ãªã©ã®é¸æŠ
- **AIåˆ¤å®š**: è¡Œå‹•çµæœã®ç”Ÿæˆãƒ»ã‚¤ãƒ™ãƒ³ãƒˆå®Œäº†æ¡ä»¶è©•ä¾¡
- **æ—¥ç¨‹é€²è¡Œ**: 
  - ã‚¤ãƒ™ãƒ³ãƒˆå®Œäº†æ™‚ï¼šAIè‡ªå‹•åˆ¤å®šã§æ¬¡æ—¥ã¸
  - é€šå¸¸æ™‚ï¼šè¡Œå‹•å›æ•°ä¸Šé™ã§æ‰‹å‹•ç¢ºèª

#### 3. æˆåŠŸ/å¤±æ•—åˆ¤å®š
- **é€²è¡Œç›£è¦–**: AIãŒå¸¸æ™‚ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç›®çš„é”æˆçŠ¶æ³ã‚’è©•ä¾¡
- **æˆåŠŸæ¡ä»¶**: è¨­å®šæ—¥æ•°å†…ã§ã®ç›®çš„é”æˆ
- **å¤±æ•—æ¡ä»¶**: æœ€å¤§æ—¥æ•°åˆ°é”æ™‚ã®ç›®çš„æœªé”æˆ
- **æœ€çµ‚åˆ¤å®š**: AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ã‚ˆã‚‹ç·åˆçš„ãªæˆå¦è©•ä¾¡

### ãƒ—ãƒ¬ã‚¤æ™‚é–“è¨­è¨ˆ
- **1æ—¥**: ç´„15åˆ†ï¼ˆè¡Œå‹•é¸æŠãƒ»çµæœå‡¦ç†ãƒ»é€²è¡Œï¼‰
- **7æ—¥é–“**: ç´„1æ™‚é–“45åˆ†ï¼ˆæ¨å¥¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰
- **ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º**: 1ã€œ365æ—¥ã§èª¿æ•´å¯èƒ½

ã“ã® TRPG AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ GM ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€å¾“æ¥ã® TRPG ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã—ã€AI ã®åŠ›ã§ã‚ˆã‚Šè±Šã‹ã§æ²¡å…¥æ„Ÿã®ã‚ã‚‹ã‚²ãƒ¼ãƒ ä½“é¨“ã‚’æä¾›ã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚æ™‚é–“åˆ¶é™ã¨ã‚¯ãƒªã‚¢æ¡ä»¶ã‚’æ˜ç¢ºã«ã™ã‚‹ã“ã¨ã§ã€ç·Šå¼µæ„Ÿã¨ã‚„ã‚ŠãŒã„ã®ã‚ã‚‹ã‚²ãƒ¼ãƒ ä½“é¨“ã‚’å‰µå‡ºã—ã€TRPG ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«æ–°ã—ã„ä¾¡å€¤ã‚’å±Šã‘ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ã‚’é€²ã‚ã¦ã„ãã¾ã™ã€‚
