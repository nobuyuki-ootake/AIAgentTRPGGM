# TRPG実装不足点・改善点 - Playwright分析結果

## 🔍 分析概要

Playwright MCPサーバーを使用した包括的なアプリケーション分析により、現在の実装状況と仕様書要件との差分を特定しました。

**分析日時**: 2025年1月6日  
**分析対象**: http://localhost:5173  
**分析方法**: Playwright MCP自動化ブラウザテスト  

## 📊 実装状況サマリー

### ✅ **優秀に実装済み (90%以上完成度)**
- TRPGセッション画面 - ダイスロール、スキルチェック、パワーチェック、AI GM統合
- キャラクター管理 - Stormbringerベース完全実装、PC/NPC/Enemy区別
- 敵キャラクター管理 - CRシステム、戦術設定、AI生成
- クエスト管理 - TRPG特化クエスト構造、難易度・報酬システム
- イベント管理 - Timeline開発者モードでの場所・時間ベースイベント配置
- 開発者モード - GM用ツールとプレイヤー体験の適切な分離

### ⚠️ **部分実装・問題あり (40-70%完成度)**
- ホーム画面ブランディング - 小説ツール表記が残存
- World Building UI - データ構造完備だが UI読み込みエラー
- Timeline画面 - データモデル存在、UI実装未完成
- バックエンド統合 - プロキシサーバー接続問題

### ❌ **未実装・大きく不足 (10%未満完成度)**
- ゲームシステム選択インターフェース
- キャラクターシート印刷・エクスポート
- AI画像生成機能（拠点・キャラクター）
- リアルタイム通信（Socket.IO）

## 🚨 **緊急度 高 (High Priority)**

### 1. ブランディング・UI一貫性の修正

#### 問題点:
- ホームページに「小説創作支援ツール」表示が残存
- 「プロジェクト」vs「キャンペーン」用語の混在
- 機能説明が小説執筆向けのまま

#### 必要な修正:
```typescript
// apps/frontend/src/pages/HomePage.tsx
- "小説創作支援ツール" → "TRPG AIエージェントGM"
- "プロジェクト" → "キャンペーン" (一貫して)
- 機能説明をTRPG向けに全面修正
```

### 2. World Building UI の修正

#### 問題点:
- 「プロジェクトが選択されていません」エラー
- 拠点管理画面が正常に表示されない
- BaseLocation仕様は実装済みだがUI連携に問題

#### 必要な修正:
```typescript
// apps/frontend/src/pages/WorldBuildingPage.tsx
// 状態管理とエラーハンドリングの改善
// 初期状態の適切な設定
// BaseTabコンポーネントとの統合確認
```

### 3. Timeline UI の完成

#### 問題点:
- 日単位タイムライン表示が空白
- セッション履歴機能が未実装
- 開発者モード二重機能が不完全

#### 必要な修正:
```typescript
// apps/frontend/src/pages/TimelinePage.tsx
// 日単位表示の実装
// セッション履歴表示ロジック
// 開発者モード切り替え機能
```

## ⚠️ **緊急度 中 (Medium Priority)**

### 4. バックエンド統合の問題解決

#### 問題点:
- pnpm install でタイムアウト
- Vite/TypeScript依存関係の問題
- プロキシサーバーとの通信エラー

#### 必要な修正:
```bash
# 依存関係の再インストール
# Cloud Run設定の確認
# Socket.IO接続の修正
```

### 5. ゲームシステム選択機能

#### 問題点:
- ゲームシステム選択インターフェースが未実装
- Stormbringerのみ対応、他システム選択不可
- ルールセット切り替え機能なし

#### 必要な実装:
```typescript
// 新規: GameSystemSelector.tsx
// TRPGCampaignにgameSystem選択
// ルールセット動的ロード機能
```

### 6. キャラクターシート印刷・エクスポート

#### 問題点:
- PDF出力機能が未実装
- キャラクターシート印刷レイアウトなし
- データエクスポート機能なし

#### 必要な実装:
```typescript
// PDF生成機能 (jsPDF使用)
// 印刷レイアウトCSS
// JSON/CSVエクスポート
```

## 📝 **緊急度 低 (Low Priority)**

### 7. AI画像生成機能

#### 問題点:
- Google Imagen 3統合が未完成
- 拠点画像生成機能なし
- キャラクター画像生成機能なし

#### 必要な実装:
```typescript
// Google AI画像生成API統合
// 画像プロンプト最適化
// Cloud Storage連携
```

### 8. リアルタイム通信

#### 問題点:
- Socket.IO実装が未完成
- マルチプレイヤーセッション未対応
- リアルタイム状態同期なし

#### 必要な実装:
```typescript
// Socket.IO クライアント/サーバー実装
// セッション状態同期
// マルチプレイヤー対応
```

## 💡 **UI/UX改善提案**

### 改善点1: ナビゲーション最適化
- サイドバーのTRPG用アイコン統一
- 開発者モード切り替えの視覚的フィードバック改善
- キャンペーン選択状態の明確化

### 改善点2: データ入力フローの改善
- キャンペーン作成ウィザード
- キャラクター作成ステップガイド
- バリデーションエラーの親切な表示

### 改善点3: セッション体験の向上
- ダイスロール結果のアニメーション改善
- キャラクター状態の視覚的表現強化
- チャット履歴の検索・フィルター機能

## 🎯 **実装優先順位**

### Phase 1 (即座に対応)
1. ホーム画面ブランディング修正 ✅
2. World Building UI読み込み問題修正
3. Timeline UI基本実装 ✅
4. クエスト・イベント分離機能

### Phase 2 (1-2週間以内)
4. バックエンド統合問題解決
5. ゲームシステム選択機能 ✅
6. キャラクターシート出力機能 ✅
7. トラップイベントシステム実装

### Phase 3 (1ヶ月以内)
7. AI画像生成機能完成
8. リアルタイム通信実装
9. マルチプレイヤー対応

## 📋 **テスト項目**

### 機能テスト
- [ ] ホーム画面のブランディング表示
- [ ] 全画面でのキャンペーン選択状態
- [ ] World Building拠点管理機能
- [ ] Timeline日程管理機能
- [ ] TRPGセッション全機能
- [ ] キャラクター作成・編集
- [ ] 敵・NPC管理
- [ ] 開発者モード切り替え

### UI/UXテスト
- [ ] レスポンシブデザイン確認
- [ ] アクセシビリティ確認
- [ ] エラーハンドリング
- [ ] ローディング状態表示
- [ ] データ永続化確認

## 📄 **関連ドキュメント**

- [TRPG Application Comprehensive Analysis](/mnt/c/Users/irure/git/AIAgentTRPGGM/TRPG_Application_Analysis.md)
- [TRPG-AIエージェントGM-プロジェクト仕様書.md](./TRPG-AIエージェントGM-プロジェクト仕様書.md)
- [TRPG GMプロジェクト用変更点-清書版.md](./TRPG\ GMプロジェクト用変更点-清書版.md)
- [TRPGプロジェクト変更のためのTODOリスト.md](./TRPGプロジェクト変更のためのTODOリスト.md)

---

**作成者**: Claude Code (Playwright MCP分析)  
**最終更新**: 2025年1月6日