# あらすじ画面機能定義

## 画面の目的と概要

あらすじ画面は、小説プロジェクトの全体像をまとめるためのインターフェースを提供します。ユーザーはこの画面で小説の概要、主要なテーマ、登場人物の関係性、物語の方向性などを自由に編集し、創作活動の基盤を構築することができます。

あらすじは小説の設計図として機能し、他の詳細な要素（キャラクター、プロット、世界観など）を構築する際の指針となります。簡潔で編集しやすいインターフェースを通じて、ユーザーの創造的思考をサポートします。

## 主要な機能一覧

1. **あらすじ表示・編集**

   - テキストエリアでの自由編集
   - マークダウン形式のサポート（オプション）
   - 編集/プレビューモードの切り替え

2. **自動保存**

   - 編集内容のリアルタイム保存
   - 更新状態の表示

3. **編集履歴**

   - 過去の編集履歴の参照（オプション）
   - 特定のバージョンへの復元機能

4. **構造化ガイド**
   - あらすじ作成のためのガイドライン表示
   - テンプレート機能（オプション）

## データ構造

主に以下のデータ構造を扱います：

```typescript
// プロジェクト内のあらすじ情報
interface SynopsisData {
  content: string;
  lastEditedAt: Date;
  // 追加的なメタデータ
}

// 編集状態
interface EditState {
  isEditing: boolean; // 編集モード/表示モードの切り替え
  isSaved: boolean; // 保存状態
  editHistory?: {
    // 編集履歴（オプション）
    timestamp: Date;
    content: string;
  }[];
}
```

## ユーザーフロー

1. **あらすじ閲覧フロー**

   - あらすじ画面にアクセス
   - 現在のあらすじ内容を確認
   - プレビューモードで整形された表示を確認

2. **あらすじ編集フロー**

   - 「編集」ボタンをクリック
   - テキストエリアであらすじを編集
   - 自動保存または「保存」ボタンをクリック
   - 保存完了の確認

3. **編集履歴参照フロー（オプション）**
   - 「履歴」ボタンをクリック
   - 過去の編集履歴一覧を表示
   - 特定の履歴を選択して内容を確認
   - 必要に応じて特定バージョンに復元

## 関連コンポーネント

- **SynopsisEditor**: あらすじ編集用テキストエリアコンポーネント
- **SynopsisPreview**: あらすじプレビュー表示コンポーネント
- **EditHistoryList**: 編集履歴表示コンポーネント（オプション）
- **GuidePanel**: あらすじ作成ガイド表示コンポーネント

## 依存関係

- **useSynopsis** フック: あらすじ画面のロジックを管理
- **currentProjectState** (Recoil): 現在選択されているプロジェクト状態
- **LocalStorage**: あらすじデータの永続化に使用
- **マークダウンパーサー**: あらすじのリッチテキスト表示（オプション）
