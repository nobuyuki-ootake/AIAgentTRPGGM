# キャラクター画面機能定義

## 画面の目的と概要

キャラクター画面は、小説内の登場人物を作成・管理するためのインターフェースを提供します。ユーザーはこの画面でキャラクターの詳細情報（名前、役割、外見、性格、背景など）を定義し、キャラクター間の関係性を構築することができます。

充実したキャラクター設定は物語に深みと説得力を与えるため、直感的な UI/UX を通じてキャラクター創造プロセスをサポートします。また、作成したキャラクター情報は物語の他の要素（プロット、タイムラインなど）と連携して活用されます。

## 主要な機能一覧

1. **キャラクター一覧表示**

   - キャラクター情報をカード形式でグリッド表示
   - キャラクター名、役割、画像のサムネイル表示
   - カテゴリ（主人公、敵対者、脇役）によるフィルタリング

2. **キャラクター詳細表示**

   - キャラクターの詳細情報の表示
   - タブ分けによる情報の整理（基本情報、背景、関係性など）
   - キャラクター画像の表示

3. **キャラクター作成・編集**

   - 新規キャラクター作成ダイアログ
   - 既存キャラクター情報の編集
   - カスタムフィールドの追加機能

4. **キャラクター関係図**

   - キャラクター間の関係性の視覚化
   - 関係性の種類（友人、家族、恋愛、敵対など）の設定
   - 双方向の関係性の管理

5. **キャラクター削除**
   - 不要なキャラクターの削除機能
   - 削除前の確認ダイアログ

## データ構造

主に以下のデータ構造を扱います：

```typescript
// キャラクター情報
interface Character {
  id: string;
  name: string;
  role: "protagonist" | "antagonist" | "supporting";
  gender?: string;
  birthDate?: string;
  description: string;
  background: string;
  motivation: string;
  traits: string[];
  relationships: CharacterRelationship[];
  imageUrl?: string;
  customFields?: CustomField[];
}

// キャラクター関係性
interface CharacterRelationship {
  characterId: string;
  relationshipType: string;
  description: string;
}

// カスタムフィールド
interface CustomField {
  id: string;
  name: string;
  value: string;
}
```

## ユーザーフロー

1. **キャラクター一覧閲覧フロー**

   - キャラクター画面にアクセス
   - 作成済みの全キャラクター一覧を表示
   - 必要に応じてフィルターを適用

2. **キャラクター作成フロー**

   - 「新規キャラクター作成」ボタンをクリック
   - キャラクター作成ダイアログが表示される
   - 必須項目と任意項目を入力
   - カスタムフィールドを必要に応じて追加
   - 「保存」ボタンをクリックでキャラクターが作成され、一覧に追加される

3. **キャラクター編集フロー**

   - 一覧からキャラクターを選択
   - 詳細表示画面で「編集」ボタンをクリック
   - 情報を編集
   - 「保存」ボタンをクリックで変更が適用される

4. **キャラクター関係性管理フロー**
   - キャラクター詳細の「関係性」タブを選択
   - 既存の関係性を確認
   - 「関係性追加」ボタンをクリック
   - 関係を持つキャラクターと関係の種類を選択
   - 関係性の詳細を入力して保存

## 関連コンポーネント

- **CharacterList**: キャラクター一覧を表示するグリッドコンポーネント
- **CharacterCard**: キャラクター情報のサマリーを表示するカード
- **CharacterDetail**: キャラクターの詳細情報を表示するコンポーネント
- **CharacterForm**: キャラクター作成・編集用フォームコンポーネント
- **RelationshipGraph**: キャラクター間の関係を視覚化するグラフコンポーネント
- **RelationshipForm**: 関係性設定用のフォームコンポーネント
- **DeleteConfirmDialog**: 削除確認用ダイアログ

## 依存関係

- **useCharacters** フック: キャラクター管理のロジックを提供
- **currentProjectState** (Recoil): 現在選択されているプロジェクト状態
- **LocalStorage**: キャラクターデータの永続化
- **画像アップロード機能**: キャラクター画像の管理（オプション）
- **グラフ描画ライブラリ**: 関係図の視覚化（オプション）
