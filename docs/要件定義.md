# 📘 AI 共創型小説作成ツール 要件定義（ブラッシュアップ版）

---

## 1. プロジェクト概要

### 1.1 目的・背景

- AI との本格的な共創による新しい創作体験を提供し、従来のチャットベース支援から脱却する。

### 1.2 ターゲットユーザー

- 作家志望者、創作初心者、現役小説家、教育機関など幅広い層。

### 1.3 想定アウトプット

- 長編／短編小説、プロット案、キャラクター設定集など多様な創作成果物。

---

## 2. 機能要件

### 2.1 AI エージェント・共創モデル

- 必要な AI エージェントの役割：
  - プロット設計者
  - キャラクター開発者
  - 文体校正者
  - アイデアブレインストーミング役
  - 編集者／批評家
- エージェントのカスタマイズ性：ユーザーが役割や性格を設定可能。
- インタラクション形式：チャット UI を基本とし、将来的にエージェント同士の議論も検討。

### 2.2 小説作成支援機能

- サポートする創作プロセス：
  - プロット構成、キャラクター設定、世界観構築、章構成、テーマ調整、推敲・リライト支援
- データ管理形式：創作プロセスごとに JSON で管理し、再利用やバージョン管理を容易に。
- 文章改善・校正機能：必要（AI による提案・校正サポートを実装）。

### 2.3 提案・対話設計

- 提案タイミング：ユーザー操作（ボタンやドラッグ）で箇所指定、または全体構成時。
- 提案表示形式：選択式＋インライン挿入。将来的に履歴・比較機能も実装。

---

## 3. UI/UX 要件

### 3.1 エディタ・インターフェース

- 本文編集 UI：
  - メインペイン(中央)であり、独自エディタ（日本語小説向け、400 字縦書き方眼紙風）を採用。
- 補助情報（プロット・人物・設定）：メインペインの内容切り替えを行うメニュー(左ペイン)。
- エージェント対話表示：分割ビューで同時進行可能。

### 3.1.1 補助情報ペイン内容

1. あらすじ
2. プロット
3. キャラクター
4. 世界観構築
5. タイムライン
6. 本文執筆
   6.1 章
7. 読者想定リアクション/エージェントによる総評

### 3.1.2 メインペイン内容

本文執筆時:

- 独自エディタ（日本語小説向け、400 字縦書き方眼紙風）
  上記以外の場合は、横書きのテキストエディタとする

### 3.2 ユーザー体験設計

- 想定創作スタイル：ゼロからの創作を主軸とし、今後コラボや既存案改良も検討。
- 共創の価値：AI 活用で矛盾の少ない構成や、読者視点のフィードバックを得られる。
- 作風・ジャンル変更 UI：途中変更は非対応。新規作成を推奨。

### 3.3 UI 詳細

- パネル構成：
  1. 工程切り替えリスト
  2. 執筆内容表示（工程フロー式）
  3. AI 対話パネル（収納可）

---

## 4. 技術的要件

### 4.1 システム構成

- 使用 AI モデル：ChatGPT または Claude を想定。
- 外部 API・連携：
  - 画像生成（Midjourney, DALL·E 等／初期リリース除外）
  - テキスト保存・バージョン管理（Firebase, Git 等／JSON 形式）
  - クラウド保存（Google Drive, Notion 等／将来検討）
- 対応デバイス：Web UI（Windows, mac 対応）
- 開発環境：
  - フロントエンド：React + TypeScript
  - 状態管理：Recoil
  - UI: Material-UI
  - テスト・開発支援：Storybook

### 4.2 データモデル

#### 4.2.1 プロジェクト構造

- `NovelProject`: 小説プロジェクト全体を表す
  - id, title, createdAt, updatedAt, synopsis
  - plot: プロット要素の配列
  - characters: キャラクター情報の配列
  - worldBuilding: 世界観設定
  - timeline: タイムライン上のイベント配列
  - chapters: 章の配列
  - feedback: フィードバック情報の配列

#### 4.2.2 プロット管理

- `PlotItem`: プロットの各項目
  - id, title, description, type, order
  - type: "イベント" | "転機" | "伏線" | "設定"

#### 4.2.3 執筆機能

- `Chapter`: 章情報
  - id, title, content, order
- `RelatedEvent`: 章に関連するイベント
  - id, title, description, chapterId

### 4.3 セキュリティ・著作権

- データ保存：ローカル保存を基本とし、ユーザーの所有権を明確化。
- 著作権方針：ユーザー所有を原則とし、利用条件も明記予定。
- バックアップ・削除：ローカル保存/再生のみ（クラウドは将来検討）。

---

## 5. 画面仕様

### 5.1 プロット画面

- 機能：
  - プロット項目の追加、編集、削除、並べ替え
  - プロット項目のタイプ分類（イベント、転機、伏線、設定）
  - ドラッグ＆ドロップによる順序変更
- 表示パターン：
  - 標準表示：プロット項目が複数ある状態
  - 空のプロット：プロット項目がない初期状態
  - 多数のプロット項目：長編小説などの大量プロット項目がある状態

### 5.2 執筆画面

- 機能：
  - 章の追加、選択、編集
  - エディタでの本文編集
  - プレビュー表示
  - 関連するプロットイベントの参照
- 表示パターン：
  - 標準表示：複数章がある状態で 1 章を編集中
  - 空の執筆画面：章がない初期状態
  - 多数の章：長編小説などの大量の章がある状態

---

## 6. 拡張性・将来展望

- マルチユーザー創作：現時点では非対応。
- 他ジャンル展開：現時点では予定なし。
- AI エージェントの学習・成長：ユーザーによる調整や好みの蓄積は現時点で非対応。

---

## 7. AI エージェント連携機能

### 7.1 対話方式

- **コンテキスト選択方式**: 画面内の要素にチェックボックスを配置し、ユーザーが対話に含めたい要素を選択できる
  - プロット項目、キャラクター情報、章内容など、各要素をチェックで選択
  - 選択された内容は自動的に AI チャットパネルのコンテキストとして取り込まれる
  - 複数要素の選択が可能で、関連要素を組み合わせた質問や提案依頼が可能

### 7.2 AI チャットパネル

- **表示位置**: 画面右側または下部に配置し、必要に応じて展開/格納可能
- **インターフェース**:
  - コンテキスト表示領域: 選択された要素が表示される
  - メッセージ入力欄: ユーザーが質問や指示を入力
  - 送信ボタン: メッセージとコンテキストを AI に送信
  - 履歴表示: 過去の対話を閲覧可能

### 7.3 AI の主要機能

- **プロット関連**:
  - 選択したプロット項目の詳細化提案
  - プロット間の矛盾チェック
  - プロットの拡張アイデア提供
  - 選択プロットに基づく章内容の草案提案
- **キャラクター関連**:
  - 選択キャラクターの深堀り
  - キャラクター間関係の提案
  - キャラクターの台詞や行動パターンの提案
- **執筆支援**:
  - 選択章の文体や表現の改善提案
  - 描写の具体化アドバイス
  - 章立てや構成の提案
  - 関連イベントを踏まえた展開提案

### 7.4 技術実装方針

- **コンテキスト管理**:
  - 選択された要素の ID と内容を Recoil で状態管理
  - AI への送信前に適切な形式にフォーマット
- **API インテグレーション**:
  - OpenAI API または Claude API を使用
  - システムプロンプトに創作支援の文脈を設定
  - ユーザー選択コンテキストとメッセージを組み合わせて API リクエスト構築
- **レスポンス処理**:
  - AI からの返答をリアルタイムでチャットパネルに表示
  - 提案内容の適用ボタンを実装（プロットや章へ反映可能に）
- **エラーハンドリング**:
  - API 接続エラー時の適切なフォールバック
  - 長文生成時のストリーミング対応
  - トークン制限管理（コンテキスト量の自動調整）

---

（本要件定義は今後の議論や開発状況に応じて随時アップデートする）
